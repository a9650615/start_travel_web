<!DOCTYPE html>
@{
    Layout = null;
}

@model  startravel_web.Models.list_view_return_data
<!-- jQuery (Bootstrap 所有外掛均需要使用) -->
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")
@Scripts.Render("~/bundles/jquery-ui")
@Scripts.Render("~/bundles/star-ui")

@Scripts.Render("~/bundles/modernizr")
@Scripts.Render("~/bundles/datepicker")

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>燦星旅遊-出國旅遊第一選擇，夢想般國外旅遊行程</title>
    <link rel="shortcut icon" href="~/Content/images/star-icon.png" />

    <link rel="shortcut icon" href="~/Content/images/star-icon.png" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="~/Content/jquery-ui.css">
    <link href="~/Content/main.css" rel="stylesheet" type="text/css">
    <link href="~/Content/HeaderFooter.css" rel="stylesheet" type="text/css">
    <link href="~/Content/step-css.css" rel="stylesheet" type="text/css">
    <link href="~/Content/style.css" rel="stylesheet" type="text/css">
    <link href="~/Content/datepicker.css" rel="stylesheet" type="text/css">


    <!-- HTML5 shim and Respond.js 讓 IE8 支援 HTML5 元素與媒體查詢 -->
    <!-- 警告：Respond.js 無法在 file:// 協定下運作 -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>

    <!-- header======================================================================= -->
    <div class="header-02">
        <div class="header-02-pc star-container">
            <div class="row">
                <div class="col-xs-12 col-sm-8 col-sm-push-4">
                    <div class="header-link">
                        <ul>
                            <li>
                                <a href="javascript:;" title="">會員登入</a> /
                                <a href="javascript:;" title="">註冊</a>
                            </li>
                            <li><a href="javascript:;" title="">查詢及付款</a></li>
                            <li><a href="javascript:;" title="">全台門市</a></li>
                            <li><a href="javascript:;" title="">企業專區</a></li>
                            <li><a href="javascript:;" title="">線上申訴</a></li>
                            <li><a href="javascript:;" title="">同業網站</a></li>
                            <li><a href="javascript:;" title=""><img src="~/Content/images/fb-icon.png" alt=""></a></li>
                            <li><a href="javascript:;" title=""><img src="~/Content/images/top-icon1.gif" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="header-rainbow">
                        <img src="~/Content/images/rainbow.png" alt="">
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 col-sm-pull-8">
                    <a class="header-logo" href="http://www.startravel.com.tw/" title="">
                        <img src="~/Content/images/logo-text.png" alt="">
                    </a>
                </div>
            </div>
            <div class="header-02-menu">
                <img src="~/Content/images/header02-1.png" alt="">
                <a class="active" href="javascript:;" title="">團體旅遊</a>
                <a href="javascript:;" title="">自由行</a>
                <a href="javascript:;" title="">郵輪</a>
                <a href="javascript:;" title="">機票</a>
                <a href="javascript:;" title="">訂房</a>
                <img src="~/Content/images/header02-2.png" alt="">
                <a href="javascript:;" title="">旅遊</a>
                <a href="javascript:;" title="">機票</a>
                <a href="javascript:;" title="">高鐵訂房</a>
                <img src="~/Content/images/header02-3.png" alt="">
                <a href="javascript:;" title="">台中出發</a>
                <a href="javascript:;" title="">高雄出發</a>
                <a href="javascript:;" title="">票券</a>
                <a href="javascript:;" title="">簽證</a>
                <a href="javascript:;" title="">運動旅遊</a>
            </div>
        </div>






        <div class="header-02-mobile">
            <a href="javascript:;">
                <img class="img-responsive" src="~/Content/images/logo-text.png" alt="">
            </a>
            <nav class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                        <span class="sr-only">選單切換</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    團體旅遊
                </div>

                <!-- 手機隱藏選單區 -->
                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <!-- 左選單 -->
                    <ul class="nav navbar-nav">
                        <li>國外</li>
                        <li class="active"><a href="#">團體旅遊</a></li>
                        <li><a href="#">自由行</a></li>
                        <li><a href="#">郵輪</a></li>
                        <li><a href="#">機票</a></li>
                        <li><a href="#">訂房</a></li>
                        <li>國內</li>
                        <li><a href="#">旅遊</a></li>
                        <li><a href="#">機票</a></li>
                        <li><a href="#">高鐵訂房</a></li>
                        <li>更多</li>
                        <li><a href="#">台中出發</a></li>
                        <li><a href="#">高雄出發</a></li>
                        <li><a href="#">票券</a></li>
                        <li><a href="#">簽證</a></li>
                        <li><a href="#">運動旅遊</a></li>
                    </ul>
                    <hr>
                    <ul class="nav navbar-nav">
                        <li><a href="javascript:;" title="">會員登入</a></li>
                        <li><a href="javascript:;" title="">註冊</a></li>
                        <li><a href="javascript:;" title="">查詢及付款</a></li>
                        <li><a href="javascript:;" title="">全台門市</a></li>
                        <li><a href="javascript:;" title="">企業專區</a></li>
                        <li><a href="javascript:;" title="">線上申訴</a></li>
                        <li><a href="javascript:;" title="">同業網站</a></li>
                        <li><a href="javascript:;" title=""><img src="~/Content/images/fb-icon.png" alt=""></a></li>
                        <li><a href="javascript:;" title=""><img src="~/Content/images/top-icon1.gif" alt=""></a></li>
                    </ul>

                </div>
                <!-- 手機隱藏選單區結束 -->
            </nav>
        </div>
    </div>

 

        @{
            DateTime grplist_s_data_s = DateTime.ParseExact(Html.DisplayFor(model => model.grplist_postdata.S_DATE_S).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
            DateTime grplist_s_data_e = DateTime.ParseExact(Html.DisplayFor(model => model.grplist_postdata.S_DATE_E).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
            string grplist_city_from = Model.city_from_name;
            string grplist_city_to = Model.city_to_name;
          

        }

    

    <!-- 內容區塊===================================================================== -->
    <div class="content content-gray">

        <!-- 搜尋條件列 -->
        <div class="search hidden-xs">
            <div class="star-container">
                <div class="searchLine">
                    <i class="glyphicon glyphicon-search"></i>
                    @(grplist_city_from)–@(grplist_city_to)／出發區間：@grplist_s_data_s.ToString("yyyy/MM/dd(ddd)")~@grplist_s_data_e.ToString("yyyy/MM/dd(ddd)")
                    <a class="searchMoreBtn" href="javascript:;" title="">更換條件</a>
                </div>
            </div>
        </div>


@using (Html.BeginForm("re_search", "List", FormMethod.Post,new{ enctype = "multipart/form-data", id = "searchForm" }))
{
        <!-- 詳細搜尋條件 -->
        <div class="searchCriteria">
            <div class="star-container">
                <div class="row">
                    <div class="col-xs-12 col-sm-2">
                        <div class="form-group">
                            <label>出發地</label>
                         
                            @Html.DropDownList("departurelist_item", (IEnumerable<SelectListItem>)ViewBag.departurelistItems, new { id = "departurelist_item", onchange = "" }) 
                            <input type="hidden" id="search_city_from" name="search_city_from" value="">
                          
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-3">
                        <div class="form-group">
                            <label>目的地</label>
                       
                            @Html.DropDownList("travelregionlist_item", (IEnumerable<SelectListItem>)ViewBag.grptravelregionlistItems, new { id = "travelregionlist_item", onchange = "" }) 
                            <input type="hidden" id="search_city_to" name="search_city_to" value="">       
                                             
                        </div>
                      </div>

                    <div class="col-xs-12 col-sm-4">
                        <div class="form-group">
                            <label>出發區間</label>
                            <input class="form-control" type="text" id="choose-date" value="@grplist_s_data_s.ToString("yyyy/MM/dd(ddd)")~@grplist_s_data_e.ToString("yyyy/MM/dd(ddd)")">
                            <input type="hidden" id="search_choose_date_s" name="search_choose_date_s" value="">
                            <input type="hidden" id="search_choose_date_e" name="search_choose_date_e" value="">
                             
                            <div class="chooseDate">
                                 
                                     <div id="widgetCalendar">
                                     </div>
                                      <div class="date-btn">
                                          <a class="date-close" href="javascript:;" title="">
                                              <i class="glyphicon glyphicon-remove"></i>
                                          </a>
                                          <a class="date-check" href="javascript:;" title="">
                                              <i class="glyphicon glyphicon-ok"></i>
                                          </a>
                                      </div>
                                    
                            </div>
                          </div>
                       </div>
                          
                    <div class="col-xs-12 col-sm-3">
                        <div class="form-group">
                            <label>旅遊形式</label>
                            <input type="hidden" id="search_travelkind" name="search_travelkind" value="">
                            <select class="TravelKind_select" id="travelkind_list">
                                @if(Model.grplist_postdata.TravelKind==0)
                                {
                                    <option selected value="0">不限</option>
                                }
                                else
                                {
                                     <option value="0">不限</option>
                                }
                               
                                @if (Model.grplist_postdata.TravelKind == 1)
                                {
                                     <option selected value="1">團體旅遊</option>
                                }
                                else
                                {
                                    <option  value="1">團體旅遊</option>
                                
                                }

                                @if (Model.grplist_postdata.TravelKind == 2)
                                {
                                     <option selected value="2">迷你小團</option>
                                }
                                else
                                {
                                    <option value="2">迷你小團</option>
                                }
                              
                            </select>
                        </div>
                    </div>
                </div>
                    <div>
                        <input class="star-input3" type="checkbox" id="ensure" name="" value="deposit" onclick="ensure_box_click()">                      
                        <label for="ensure"></label>
                        <span class="search-checkbox">保證出團</span>
                        <input type="hidden" id="search_is_ensure" name="search_is_ensure" value="">

                    </div>
                    <div class="searchCriteriaList">
                        <div class="searchCriteriaListItem tour_day">
                            <input type="hidden" id="search_tour_day" name="search_tour_day" value="">
                            <span>行程天數：</span>

                            @if (Model.grplist_postdata.tourday == "GE1")
                            {
                                <a class="active" href="javascript:;" onclick="search_tour_day_click(this)" title="">不限</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_tour_day_click(this)" title="">不限</a>
                            }


                            @if(Model.grplist_postdata.tourday=="LE4")
                            {
                                <a class="active" href="javascript:;" onclick="search_tour_day_click(this)"  title="">4天以下</a>
                            }
                            else
                            {
                                <a  href="javascript:;" onclick="search_tour_day_click(this)"  title="">4天以下</a>
                            }
                            
                            @if (Model.grplist_postdata.tourday == "EQ5")
                            {
                             <a class="active"  href="javascript:;" onclick="search_tour_day_click(this)" title="">5天</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_tour_day_click(this)" title="">5天</a> 
                            }

                            @if (Model.grplist_postdata.tourday == "EQ6")
                            {
                                <a class="active" href="javascript:;" onclick="search_tour_day_click(this)" title="">6天</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_tour_day_click(this)" title="">6天</a>
                            }
   
                            @if (Model.grplist_postdata.tourday == "GE7")
                            {
                                <a class="active" href="javascript:;" onclick="search_tour_day_click(this)" title="">7天以上</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_tour_day_click(this)" title="">7天以上</a>
                            }
                         
                            
                           
                        </div>
                        <div class="searchCriteriaListItem stime">
                            <input type="hidden" id="search_stime_s" name="search_stime_s" value="">
                            <input type="hidden" id="search_stime_e" name="search_stime_e" value="">
                            <span>出發時間：</span>
                            @if (Model.grplist_postdata.S_TIME_S == "" && Model.grplist_postdata.S_TIME_E == "")
                            {
                                <a class="active" href="javascript:;" onclick="search_stime_click(this)" title="">不限</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_stime_click(this)" title="">不限</a>
                            }
                            @if (Model.grplist_postdata.S_TIME_S == "000000" && Model.grplist_postdata.S_TIME_E== "060000") 
                            { 
                               <a class="active" href="javascript:;" onclick="search_stime_click(this)" title="">00:00-06:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_stime_click(this)" title="">00:00-06:00</a>
                            }
                            @if (Model.grplist_postdata.S_TIME_S == "060000" && Model.grplist_postdata.S_TIME_E == "120000")
                            {
                                <a class="active" href="javascript:;" onclick="search_stime_click(this)" title="">06:00-12:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_stime_click(this)" title="">06:00-12:00</a>
                            }
                            @if (Model.grplist_postdata.S_TIME_S == "120000" && Model.grplist_postdata.S_TIME_E == "180000")
                            {
                                <a class="active" href="javascript:;" onclick="search_stime_click(this)" title="">12:00-18:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_stime_click(this)" title="">12:00-18:00</a>
                            }
                            @if (Model.grplist_postdata.S_TIME_S == "180000" && Model.grplist_postdata.S_TIME_E == "235900")
                            {
                                <a class="active" href="javascript:;" onclick="search_stime_click(this)" title="">18:00-24:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_stime_click(this)" title="">18:00-24:00</a>
                            }

                           
                        </div>
                        <div class="searchCriteriaListItem etime">
                            <input type="hidden" id="search_etime_s" name="search_etime_s" value="">
                            <input type="hidden" id="search_etime_e" name="search_etime_e" value="">
                            <span>回程時間：</span>
                            @if (Model.grplist_postdata.E_TIME_S == "" && Model.grplist_postdata.E_TIME_E == "")
                            {
                                <a class="active" href="javascript:;" onclick="search_etime_click(this)" title="">不限</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_etime_click(this)" title="">不限</a>
                            }
                            @if (Model.grplist_postdata.E_TIME_S == "000000" && Model.grplist_postdata.E_TIME_E == "060000")
                            {
                                <a class="active" href="javascript:;" onclick="search_etime_click(this)" title="">00:00-06:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_etime_click(this)" title="">00:00-06:00</a>
                            }
                            @if (Model.grplist_postdata.E_TIME_S == "060000" && Model.grplist_postdata.E_TIME_E == "120000")
                            {
                                <a class="active" href="javascript:;" onclick="search_etime_click(this)" title="">06:00-12:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_etime_click(this)" title="">06:00-12:00</a>
                            }
                            @if (Model.grplist_postdata.E_TIME_S == "120000" && Model.grplist_postdata.E_TIME_E == "180000")
                            {
                                <a class="active" href="javascript:;" onclick="search_etime_click(this)" title="">12:00-18:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_etime_click(this)" title="">12:00-18:00</a>
                            }
                            @if (Model.grplist_postdata.E_TIME_S == "180000" && Model.grplist_postdata.E_TIME_E == "235900")
                            {
                                <a class="active" href="javascript:;" onclick="search_etime_click(this)" title="">18:00-24:00</a>
                            }
                            else
                            {
                                <a href="javascript:;" onclick="search_etime_click(this)" title="">18:00-24:00</a>
                            }
                        </div>
                    </div>
                   <input type="submit" class="research" title="" onclick="research_button_click()" value="重新搜尋" />
                   <input type="hidden" id="which_button" name="which_button" value="">
                    
                    <a class="cancelSearch" href="javascript:;" title="">
                        取消
                    </a>
                </div>
            </div>

            if (Model.grplist_result.rCode.Equals("0001"))
            {
                int Search_result_total = Int32.Parse(Html.DisplayFor(model => model.grplist_result.Data.Total).ToString());
                int Search_result_pagesize = Int32.Parse(Html.DisplayFor(model => model.grplist_result.Data.PageSize).ToString());
                int Search_result_currentpage = Int32.Parse(Html.DisplayFor(model => model.grplist_result.Data.CurrentPage).ToString());
                //int Search_result_currentpage = int.Parse(Html.DisplayFor(model => model.grplist_result.Data.CurrentPage).ToString(), System.Globalization.NumberStyles.AllowDecimalPoint);
                // string Search_result_total = Html.DisplayFor(model => model.grplist_result.Data.Total).ToString();

                int total_page = 0;

                if (Search_result_total % Search_result_pagesize == 0)
                {
                    total_page = Search_result_total / Search_result_pagesize;
                }
                else
                {
                    total_page = (Search_result_total / Search_result_pagesize) + 1;
                }
                   <!-- 搜尋比數與排列 -->


                <input type="hidden" id="order_type_1" name="order_type_1" value="">
                <div class="conditions star-container">
                    <div class="row">
                        <div class="col-xs-12 col-sm-8">
                            <div class="row">
                                <div class="col-xs-4">
                                    @if (Model.grplist_postdata.order_type.Equals("PriceInc"))
                                    {
                                        <div class="updown price active" id="price">
                                            <span class="up"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">價格</a>
                                        </div>
                                    }
                                    else if (Model.grplist_postdata.order_type.Equals("PriceDesc"))
                                    {
                                        <div class="updown price active" id="price">
                                            <span class="down"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">價格</a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="updown price" id="price">
                                            <span class=""></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">價格</a>
                                        </div>
                                    }
                                </div>
                                <div class="col-xs-4">
                                    @if (Model.grplist_postdata.order_type.Equals("DayInc"))
                                    {
                                        <div class="updown day active" id="day">
                                            <span class="up"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">天數</a>
                                        </div>
                                    }
                                    else if (Model.grplist_postdata.order_type.Equals("DayDesc"))
                                    {
                                        <div class="updown day active" id="day">
                                            <span class="down"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">天數</a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="updown day" id="day">
                                            <span class=""></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">天數</a>
                                        </div>
                                    }
                                </div>
                                <div class="col-xs-4">
                                    @if (Model.grplist_postdata.order_type.Equals("SdateInc"))
                                    {
                                        <div class="updown start_date active" id="start_date">
                                            <span class="up"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">出發日</a>
                                        </div>
                                    }
                                    else if (Model.grplist_postdata.order_type.Equals("SdateDesc"))
                                    {
                                        <div class="updown start_date active" id="start_date">
                                            <span class="down"></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">出發日</a>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="updown start_date" id="start_date">
                                            <span class=""></span>
                                            <a href="javascript:;" title="" onclick="conditions_order(this)">出發日</a>
                                        </div>
                                    }
                                </div>
                            </div>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <div class="numberOfSearches col-xs-12 col-sm-6" style="text-align:right;">
                            @Search_result_currentpage/共 @total_page 頁
                        </div>
                    </div>
                    
                    </div>
                </div>
        

                <!-- 灰色區塊開始 -->
                <div class="star-container hidden-xs">

                <!-- 結果列表 -->
                <div class="searchResultsList">

                            @{int i=0;}

               @for (i = 0; i < Model.grplist_result.Data.prod.Count;i=i+1 )
                {

                    var item= Model.grplist_result.Data.prod[i];
                    int number=i+1;
                <!-- 第一筆 -->
                <div class="star-searchResultsItem">
                        <div class="row">
                            <div class="star-searchResultsItemLeft col-xs-12 col-sm-9">
                                <div class="number">
                                    <span>@(number +Model.grplist_postdata.PageSize*(Model.grplist_postdata.CurrentPage-1))</span>
                                    <input type="hidden" id="pord_no_list_@number" name="prod_no_list_@number" value="@item.GrpList[0].Prod_NO">
                                    <input type="hidden" id="grp_no_list_@number" name="grp_no_list_@number" value="@item.GrpList[0].GRP_NO">
                                </div>
                                <h3>
                                    
                                     <a title=""> @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.Prod_Name).ToString()))</a>
                             </h3>
                                <div class="row">
                                    <div class="col-xs-12 col-sm-4">
                                        <div class="star-searchResultsItemLeft-img">
                                            <img class="img-100" src="http://www.startravel.com.tw/@Html.DisplayFor(modelitem => item.Image_URL).ToString()">
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-8">
                                        <div class="abgne-star-carousel mb-10">
                                            <div class="star-btn">
                                                <a href="javascript:;" class="prev star-left0@(i+1)" onclick="new_prev_list_function('0,@Html.DisplayFor(modelitem => number),@Html.DisplayFor(modelitem => item.GrpList.Count),0,0')">
                                                    <i class="glyphicon glyphicon-chevron-left"></i>
                                                </a>
                                                <a href="javascript:;" class="next star-right0@(i+1)" onclick="new_prev_list_function('0,@Html.DisplayFor(modelitem => number),@Html.DisplayFor(modelitem => item.GrpList.Count),1,0')">
                                                    <i class="glyphicon glyphicon-chevron-right"></i>
                                                </a>

                                            </div>
                                            <div class="star-list-title">
                                                <div>
                                                    @grplist_city_from 出發
                                                </div>
                                                <div>
                                                    去程
                                                </div>
                                                <div>
                                                    回程
                                                </div>
                                            </div>
                                            <div class="frame">
                                                   <ul class="star-list0@(i+1) star-list">
                                                    



                            @{int j=0;
                              
                             }
                            @for (j = 0; j < item.GrpList.Count;j=j+1 )
                                                {
                                                    var item_grplist= item.GrpList[j];
                                                    string string_s_date = Html.DisplayFor(modelitem => item_grplist.S_DATE).ToString();
                                                    DateTime current_day = DateTime.ParseExact(string_s_date.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                                    DateTime s_depart_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[0].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                    DateTime s_arrive_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[0].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                    string s_city_from = Html.DisplayFor(modelitem => item_grplist.FlyList[0].CITY_FROM_NAME).ToString();
                                                    string s_city_to = Html.DisplayFor(modelitem => item_grplist.FlyList[0].CITY_TO_NAME).ToString();
                                                    string s_air_name = Html.DisplayFor(modelitem => item_grplist.FlyList[0].AIR_NAME).ToString();
                                                    string s_fly_no = Html.DisplayFor(modelitem => item_grplist.FlyList[0].FLY_NO).ToString();
                                                    DateTime e_depart_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[1].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                    DateTime e_arrive_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[1].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                    string e_city_from = Html.DisplayFor(modelitem => item_grplist.FlyList[1].CITY_FROM_NAME).ToString();
                                                    string e_city_to = Html.DisplayFor(modelitem => item_grplist.FlyList[1].CITY_TO_NAME).ToString();
                                                    string e_air_name = Html.DisplayFor(modelitem => item_grplist.FlyList[1].AIR_NAME).ToString();
                                                    string e_fly_no = Html.DisplayFor(modelitem => item_grplist.FlyList[1].FLY_NO).ToString();
                                
                                                    int int_QTY_KK = int.Parse(Html.DisplayFor(modelitem => item_grplist.QTY_KK).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                                                    int int_Price = int.Parse(Html.DisplayFor(modelitem => item_grplist.Price).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

                                                    string qty_kk_s = int_QTY_KK.ToString("#,#");
                                                    string Price_s = int_Price.ToString("#,#");
                                                    qty_kk_s = qty_kk_s == "" ? "0" : qty_kk_s;
                                                    Price_s = Price_s == "" ? "0" : Price_s;

                                
                                                           <li>
                                                                   <div class="text-purple text-bold">
                                                                        <input type="text" style="display: none" id="every_pord_no_@(number)_@j" name="every_pord_no_@(number)_@j" value="@item_grplist.Prod_NO">
                                                                       <input type="text" style="display: none" id="every_grp_no_@(number)_@j" name="every_grp_no_@(number)_@j" value="@item_grplist.GRP_NO">
                                                                       <input type="text" style="display: none" id="every_qty_kk_@(number)_@j" name="every_qty_kk_@(number)_@j" value="@qty_kk_s">
                                                                       <input type="text" style="display: none" id="every_price_@(number)_@j" name="every_price_@(number)_@j" value="@Price_s">
                                                                     
                                                          @{
                                                             if (int_QTY_KK > 0) {
                                                           <a  title="">@current_day.ToString("MM/dd(ddd)")</a> @:可報 @int_QTY_KK 位
                                                               if(item_grplist.DEPARTURE_FLAG.Equals("1"))
                                                               { 
                                                               <a class="ensure" href="javascript:;" title="">保出</a>
                                                                }
                                                               }else{ <a href="detail.html" title="">@current_day.ToString("MM/dd(ddd)")</a>  @: 關團
                                                                } 
                                                                } </div>
                                                                   <div>
                                                                       @s_depart_time.ToString("HH:mm") @s_city_from/@s_arrive_time.ToString("HH:mm")@s_city_to  @s_air_name
                                                                   </div>
                                                                   <div>
                                                                      @e_depart_time.ToString("HH:mm") @e_city_from/@e_arrive_time.ToString("HH:mm")@e_city_to  @e_air_name
                                                                   </div>
                                                               </li>
                                                }
                                                   </ul>
                                            </div>
                                        </div>

                                        <div class="more-date">
                                           
                                           
                                                @for (int n = 0; n < item.GrpList.Count; n = n + 1)
                                               {
                                                      var item_grplist_s = item.GrpList[n];
                                                      string string_s_date = Html.DisplayFor(modelitem => item_grplist_s.S_DATE).ToString();
                                                    DateTime current_day = DateTime.ParseExact(string_s_date.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);

                                                   if (n == (item.GrpList.Count - 1))
                                                   {
                                                           <a onclick="new_prev_list_function('1,@Html.DisplayFor(modelitem => number),0,0,@Html.DisplayFor(modelitem => n)')" title="">@current_day.ToString("MM/dd(ddd)")</a>
                                                       if (item.GrpList.Count > 3)
                                                       {
                                                        <a class="more-date-more" href="javascript:;" id="@(i+1)" title="" onclick="detail_button_click(this)">更多</a>
                                                       }
                                                   }
                                                   else
                                                   {
                                                         <a onclick="new_prev_list_function('1,@Html.DisplayFor(modelitem => number),0,0,@Html.DisplayFor(modelitem => n)')" title="">@current_day.ToString("MM/dd(ddd)")</a>@:|
                                                    }
                                                    
                                                    

                                               }
    
                                        </div>
                                    </div>
                                </div>




                            </div>

                            @{
                         string price = Html.DisplayFor(modelitem => item.Price).ToString();
                         int price_d = int.Parse(price, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

                         string qkk = Html.DisplayFor(modelitem => item.GrpList[0].QTY_KK).ToString();

                         int qkk_d = int.Parse(qkk, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

                         DateTime s_date = DateTime.ParseExact(Html.DisplayFor(modelitem => item.GrpList[0].FlyList[0].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                         DateTime e_date = DateTime.ParseExact(Html.DisplayFor(modelitem => item.GrpList[0].FlyList[1].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);

                         TimeSpan different_s_tour = new TimeSpan(e_date.Ticks - s_date.Ticks);
                         int final_day=different_s_tour.Days+1;
                        }
                            <div class="star-searchResultsItemRight col-xs-12 col-sm-3">
                                <h1>@final_day<small>天</small></h1>
                                <h2 class="final_price_@number">@price_d.ToString("#,#") <small>元起</small></h2>
                               
                                <ul>
                                    <li class="qkk_@(i+1)">@qkk_d 人以上成行</li>
                                    <li>送旅遊金</li>
                                </ul>
                                <a class="viewItinerary" id="@(i+1)" href="javascript:;"  onclick="detail_button_click(this)" title="">查看行程</a>
                                <input type="hidden" id="final_prod" name="final_prod" value="">
                                <input type="hidden" id="final_grp" name="final_grp" value="">

                            </div>
                        </div>
                    </div>

                            }
                </div>



              


                <!-- 頁碼 -->
                    <input type="hidden" id="research_page" name="research_page" value="">
                   <ul class="star-pager pager hidden-xs">
                    <li><a href="javascript:;" onclick="left_button_click()"></a></li>

                 @for (i = 0; i < total_page;i=i+1 ){
                      if(Search_result_currentpage==i+1)
                      {
                          <li class="page active @(i+1)" ><a href="javascript:;" onclick="page_button_click(this)">@(i + 1)</a></li>
                      }
                      else
                      {
                        <li class="page @(i+1)"> <a href="javascript:;" onclick="page_button_click(this)">@(i + 1)</a></li>
                      }
                 }
                    <li><a href="javascript:;" onclick="right_button_click()"></a></li>
                </ul>

                  <script>
                      function isScrolledIntoView(elem)
                      {
                          var docViewTop = $(window).scrollTop();
                          var docViewBottom = docViewTop + $(window).height();

                          var elemTop = $(elem).offset().top;
                          var elemBottom = elemTop + $(elem).height()

                          return ((docViewBottom > (elemTop+ $(elem).height()) ))
                      }

                      $(document).ready(() => {
                          var start = false
                          $(window).scroll(() => {
                              if (@(Search_result_currentpage)==@total_page) {
                                  $('#mobile-loadmore').text('沒有資料了')
                                 
                              }
                              else
                                  if (isScrolledIntoView('#mobile-loadmore') && $(window).width() < 767 && !start) {
                                      $("html, body").stop().animate({scrollTop:0}, 500, 'swing', () => $("html, body").scrollTop(0));
                                      to_page(@(Search_result_currentpage)+1);
                                      start = true;
                                  }
                          })
                      })
                  </script>



            </div>
          }else
          {
              <div class="alert" >
	                	<div class="alert_word">
		                	<p>很抱歉，沒有符合您查詢條件的資料</p>
		                	<ul>
		                		<label>建議您：</label>
			                	<li>重新調整搜尋條件</li>
			                	
		                	</ul>
	                	</div>	
	                </div>

          }
       


    <script>

        var list_1 = 0;
        var list_2 = 0;
        var list_3 = 0;
        var list_4 = 0;
        var list_5 = 0;

        var item_location = 0;

        function new_prev_list_function(k) {
            var NewArray = new Array();
            NewArray = k.split(",");
            console.log(k);
          
            var ary_item = ".star-list0" + NewArray[1];
            var width = $(ary_item+' >li').width();

            if (parseInt(NewArray[0]) == 0) {

            
            if ( parseInt(NewArray[3]) == 0) {//left

                if ( parseInt(NewArray[1]) == 1) {
                    if (list_1 > 0) {
                        $(ary_item).animate({ left: "+="+ width +"px" }, 5);
                        list_1 -= 1;
                    } else {
                        $(ary_item).animate({ left: "0px" }, 5);
                        list_1 = 0;
                    }
                } else if ( parseInt(NewArray[1]) == 2) { 
                    if (list_2 > 0) {
                        $(ary_item).animate({ left: "+="+ width +"px" }, 5);
                        list_2 -= 1;
                    } else {
                        $(ary_item).animate({ left: "0px" }, 5);
                        list_2 = 0;
                    }
                } else if ( parseInt(NewArray[1] )== 3) {
                    if (list_3 > 0) {
                        $(ary_item).animate({ left: "+="+ width +"px" }, 5);
                        list_3 -= 1;
                    } else {
                        $(ary_item).animate({ left: "0px" }, 5);
                        list_3 = 0;
                    }
                } else if ( parseInt(NewArray[1]) == 4) {
                    if (list_4 > 0) {
                        $(ary_item).animate({ left: "+="+ width +"px" }, 5);
                        list_4 -= 1;
                    } else {
                        $(ary_item).animate({ left: "0px" }, 5);
                        list_4 = 0;
                    }
                } else if ( parseInt(NewArray[1] )== 5) {
                    if (list_5 > 0) {
                        $(ary_item).animate({ left: "+="+ width +"px" }, 5);
                        list_5 -= 1;
                    } else {
                        $(ary_item).animate({ left: "0px" }, 5);
                        list_5 = 0;
                    }
                }
            } else {  //right
              

                    if ( parseInt(NewArray[1]) == 1) {
                        if (list_1 < ( parseInt(NewArray[2]) - 1)) {
                                 $(ary_item).animate({ left: "-="+ width +"px" }, 5);
                                  list_1 += 1;
                            }
                              else {
                              // $(ary_item).animate({ left: "0px" }, 5);
                               //list_1 = 0;
                           }
                    } else if ( parseInt(NewArray[1]) == 2) {

                        if (list_2 < ( parseInt(NewArray[2]) - 1)) {
                               $(ary_item).animate({ left: "-="+ width +"px" }, 5);
                               list_2 += 1;
                           }
                           else {
                              // $(ary_item).animate({ left: "0px" }, 5);
                               //list_2 = 0;
                           }

                    } else if ( parseInt(NewArray[1] )== 3) {

                        if (list_3 < ( parseInt(NewArray[2]) - 1)) {
                               $(ary_item).animate({ left: "-="+ width +"px" }, 5);
                               list_3 += 1;
                           }
                           else {
                              // $(ary_item).animate({ left: "0px" }, 5);
                               //list_3 = 0;
                           }

                    } else if ( parseInt(NewArray[1]) == 4) {

                        if (list_4 < ( parseInt(NewArray[2]) - 1)) {
                               $(ary_item).animate({ left: "-="+ width +"px" }, 5);
                               list_4 += 1;
                           }
                           else {
                             //  $(ary_item).animate({ left: "0px" }, 5);
                            //   list_4 = 0;
                           }

                    } else if ( parseInt(NewArray[1] )== 5) {

                        if (list_5 < ( parseInt(NewArray[2] )- 1)) {
                               $(ary_item).animate({ left: "-="+ width +"px" }, 5);
                               list_5 += 1;
                           }
                           else {
                           //    $(ary_item).animate({ left: "0px" }, 5);
                           //    list_5 = 0;
                           }

                       }
                           
                }
                //  console.log(list_1);
                 // console.log(list_2);

            } else {

                item_location = parseInt(NewArray[4]) * parseInt(width);
                var location_s = "-" + item_location + "px";
                $(ary_item).animate({ left: location_s }, 5);
                console.log("else");
               
                if (NewArray[1] == 1) {
                    list_1 = parseInt(NewArray[4]);
                } else if (NewArray[1] == 2) {
                    list_2 = parseInt(NewArray[4]);
                } else if (NewArray[1] == 3) {
                    list_3 = parseInt(NewArray[4]);
                } else if (NewArray[1] == 4) {
                    list_4 = parseInt(NewArray[4]);
                } else if (NewArray[1] == 5) {
                    list_5 = parseInt(NewArray[4]);
                }

                //console.log(list_1);
                //console.log(list_2);
            }


            //prod_no & grp_no & qty_kk  &price

           

            if (NewArray[1] == 1) {

                   var current_no_prod_tag="#every_pord_no_"+parseInt(NewArray[1])+"_"+list_1;
                   var current_no_grp_tag="#every_grp_no_"+parseInt(NewArray[1])+"_"+list_1;
                   var current_no_qty_kk_tag="#every_qty_kk_"+parseInt(NewArray[1])+"_"+list_1;
                   var current_no_price_tag="#every_price_"+parseInt(NewArray[1])+"_"+list_1;

                   var current_no_prod=$(current_no_prod_tag).val();
                   var current_no_grp=$(current_no_grp_tag).val();
                   var current_no_qty_kk=$(current_no_qty_kk_tag).val();
                   var current_no_price=$(current_no_price_tag).val();


               } else if (NewArray[1] == 2) {
                  
                   var current_no_prod_tag="#every_pord_no_"+parseInt(NewArray[1])+"_"+list_2;
                   var current_no_grp_tag="#every_grp_no_"+parseInt(NewArray[1])+"_"+list_2;
                   var current_no_qty_kk_tag="#every_qty_kk_"+parseInt(NewArray[1])+"_"+list_2;
                   var current_no_price_tag="#every_price_"+parseInt(NewArray[1])+"_"+list_2;

                   var current_no_prod=$(current_no_prod_tag).val();
                   var current_no_grp=$(current_no_grp_tag).val();
                   var current_no_qty_kk=$(current_no_qty_kk_tag).val();
                   var current_no_price=$(current_no_price_tag).val();


               } else if (NewArray[1] == 3) {
                  
                   var current_no_prod_tag="#every_pord_no_"+parseInt(NewArray[1])+"_"+list_3;
                   var current_no_grp_tag="#every_grp_no_"+parseInt(NewArray[1])+"_"+list_3;
                   var current_no_qty_kk_tag="#every_qty_kk_"+parseInt(NewArray[1])+"_"+list_3;
                   var current_no_price_tag="#every_price_"+parseInt(NewArray[1])+"_"+list_3;

                   var current_no_prod=$(current_no_prod_tag).val();
                   var current_no_grp=$(current_no_grp_tag).val();
                   var current_no_qty_kk=$(current_no_qty_kk_tag).val();
                   var current_no_price=$(current_no_price_tag).val();

               } else if (NewArray[1] == 4) {
                
                   var current_no_prod_tag="#every_pord_no_"+parseInt(NewArray[1])+"_"+list_4;
                   var current_no_grp_tag="#every_grp_no_"+parseInt(NewArray[1])+"_"+list_4;
                   var current_no_qty_kk_tag="#every_qty_kk_"+parseInt(NewArray[1])+"_"+list_4;
                   var current_no_price_tag="#every_price_"+parseInt(NewArray[1])+"_"+list_4;

                   var current_no_prod=$(current_no_prod_tag).val();
                   var current_no_grp=$(current_no_grp_tag).val();
                   var current_no_qty_kk=$(current_no_qty_kk_tag).val();
                   var current_no_price=$(current_no_price_tag).val();


               } else if (NewArray[1] == 5) {
                  
                   var current_no_prod_tag="#every_pord_no_"+parseInt(NewArray[1])+"_"+list_5;
                   var current_no_grp_tag="#every_grp_no_"+parseInt(NewArray[1])+"_"+list_5;
                   var current_no_qty_kk_tag="#every_qty_kk_"+parseInt(NewArray[1])+"_"+list_5;
                   var current_no_price_tag="#every_price_"+parseInt(NewArray[1])+"_"+list_5;

                   var current_no_prod=$(current_no_prod_tag).val();
                   var current_no_grp=$(current_no_grp_tag).val();
                   var current_no_qty_kk=$(current_no_qty_kk_tag).val();
                   var current_no_price=$(current_no_price_tag).val();


               }

            var list_no=NewArray[1];
            var list_prod_no_string = "#pord_no_list_"+list_no;
            var list_grp_no_string = "#grp_no_list_"+list_no;
            var qkk_no=".qkk_"+NewArray[1];
            var price_no=".final_price_"+NewArray[1];

            $(list_prod_no_string).val(current_no_prod);
            $(list_grp_no_string).val(current_no_grp);
            $(qkk_no).text(current_no_qty_kk+" 人以上成行");
            $(price_no).html(current_no_price+" <small>元</small>");

            console.log(current_no_price);

        }



    </script>


    <script>

      
       


      //  $('#searchForm').submit(submit_function());


        function ensure_box_click() {

            var checked_box_value = $('#ensure').is(':checked');

            if (checked_box_value == true) {
                $('#search_is_ensure').val(1);

            } else {
                $('#search_is_ensure').val(0);
            }
        }

        function search_tour_day_click(th) {


            $('.tour_day').children('.active').removeClass("active");
            $(th).addClass("active");

            var y = $(th).text();
            var final_tour_day_no;
            if(y=="不限")
            {

           
                    final_tour_day_no = "GE1" ;
        

            }else{

         
                var y_s = y.substr(0, 1);
                
                // y.substr(0, 1);
                if (y_s == 4) {
                    final_tour_day_no = "LE" + y_s;
                }
                else if (y_s == 7) {

                    final_tour_day_no = "GE" + y_s;
                } else if(y_s == 5){

                    final_tour_day_no = "EQ" + y_s;
                } else if(y_s == 6){

                    final_tour_day_no = "EQ" + y_s;
                }

            }

            $('#search_tour_day').val(final_tour_day_no);
            console.log($('#search_tour_day').val());
        }

        function search_stime_click(th) {


            $('.stime').children('.active').removeClass("active");
            $(th).addClass("active");

            var y = $(th).text();

            if(y=="不限")
            {
                $('#search_stime_s').val("00:00");
                $('#search_stime_e').val("23:59");


            }else{
                var stime_NewArray = new Array();
                stime_NewArray = y.split("-");

                if (stime_NewArray[1] == "24:00") {
                    stime_NewArray[1] = "23:59";
                }

                // y.substr(0, 1);
                $('#search_stime_s').val(stime_NewArray[0]);
                $('#search_stime_e').val(stime_NewArray[1]);
                console.log($('#search_stime_s').val());
                console.log($('#search_stime_e').val());
            
            }

        }

        function search_etime_click(th) {

            $('.etime').children('.active').removeClass("active");
            $(th).addClass("active");

            var y = $(th).text();

            if(y=="不限")
            {
                $('#search_etime_s').val("00:00");
                $('#search_etime_e').val("23:59");


            }else{

                var etime_NewArray = new Array();
                etime_NewArray = y.split("-");

                if (etime_NewArray[1] == "24:00")
                {
                    etime_NewArray[1] = "23:59";
                }

                // y.substr(0, 1);
                $('#search_etime_s').val(etime_NewArray[0]);
                $('#search_etime_e').val(etime_NewArray[1]);
                console.log($('#search_etime_s').val());
                console.log($('#search_etime_e').val());
            }
        }

    </script>



    <script type="text/javascript">
    $(document).ready(function () {

  
        ///datepicker

        $('#choose-date').click(function () {
            $('.chooseDate').show();
        });

        $('.date-check').click(function () {
            $('.chooseDate').hide();
        });

        $('.date-close').click(function () {
            $('.chooseDate').hide();
        });

        $('#widgetCalendar').DatePicker({
            flat: true,
            format: 'Y/m/d (w)',
            date: [new Date(), new Date()],
            calendars: 2,
            mode: 'range',
            starts: 1,
            onChange: function (formated) {
                let startDate = new Date(formated[0])
                let endDate = new Date(formated[1])

                if (startDate <  new Date()) {
                    startDate = new Date(new Date().toDateString())
                    $('#widgetCalendar').DatePickerSetDate(startDate, true)
                }

                let format = $('#widgetCalendar').DatePickerGetDate(true);
                $('#choose-date').val(format.join('~'));
            }

        });

        var state = false;

        $(function () {
            var height = $(".datepickerContainer table").height();
            // console.log(height);
            //$('#widgetCalendar').stop().animate({ height: state ? 0 : (($('#widgetCalendar div.datepicker').get(0).offsetHeight) + 215) }, 500);
            state = !state;
            return false;
        });
        //$(".datepickerContainer").find("table").last(".datepickerViewDays").parent("td").addClass("lasttable");

        $(".datepickerContainer").addClass("choose-date-table");
        $(".datepickerContainer").find('table').find('tbody').find('tr').find('td').find('.datepickerViewDays').find('thead').find('tr').find('.datepickerMonth').find('a').find('span').addClass("text-purple");

        $(".datepickerContainer").find('table').find('.datepickerViewDays').find('thead').find('tr').find('.datepickerMonth').attr('colspan', '5');
        //var x = $(".datepickerContainer").find('table').find('thead').find('tr').find('th').find('.datepickerMonth').attr('colspan');
        //console.log(x);
    });
    </script>


    <script type="text/javascript">

        function conditions_order(th) {

            //  document.forms[1].action = "List";
            // document.forms[1].method = "order_search";
            // console.log(th);
            //  $('.conditions')({
            var current_type = $(th).siblings('span').attr("class");
            var current_id = $('.conditions .updown.active').attr("id");
            var click_id     = $(th).parent().attr("id");
            console.log(current_id)

            if (current_type == "up") {
                $('.conditions .updown.active').children('span').removeClass("up");
            } else {
                $('.conditions .updown.active').children('span').removeClass("down");
            }

            if (current_id == click_id) {
                if (current_type == "up") {
                    $(th).siblings('span').addClass("down");

                } else {
                    $(th).siblings('span').addClass("up");
                }
            }else{
                $(th).siblings('span').addClass("up");
            }

            $('.conditions .updown.active').removeClass("active");

            $(th).parent().addClass("active");


            //console.log(y);
            $('#which_button').val("0");




            $('#searchForm').submit();
            //document.forms[1].submit();
            //});
        }



         function research_button_click() {
              $('#which_button').val("2");
              $('#searchForm').submit();
          }



        function page_button_click(th) {
            
            
            $('#which_button').val("0");

            $('.star-pager').find('.active').removeClass("active");
            $(th).parent().addClass("active");


            $('#searchForm').submit();
        }

        function to_page(index) {
            $('#research_page').val(index);
            $('.star-pager').find('.active').children('a').text(index)
            page_button_click($('.star-pager').find('.active').children('a'));
            //$('#searchForm').submit();
        }

    
        function detail_button_click(th){

            $('#which_button').val("1");
            // var NewArray = new Array();
            var list_no;
            //NewArray = th.split(",");
            console.log(th);

            list_no=$(th).attr("id");


            if(parseInt(list_no)==1)
            {
                var prod_value= $('#pord_no_list_1').val();
                $('#final_prod').val(prod_value);

                var grp_value= $('#grp_no_list_1').val();
                $('#final_grp').val(grp_value);

            }else if(parseInt(list_no)==2)
            {
                var prod_value= $('#pord_no_list_2').val();
                $('#final_prod').val(prod_value);

                var grp_value= $('#grp_no_list_2').val();
                $('#final_grp').val(grp_value);

            }else if(parseInt(list_no)==3)
            {
                var prod_value= $('#pord_no_list_3').val();
                $('#final_prod').val(prod_value);

                var grp_value= $('#grp_no_list_3').val();
                $('#final_grp').val(grp_value);
            
            }else if(parseInt(list_no)==4)
            {
                var prod_value= $('#pord_no_list_4').val();
                $('#final_prod').val(prod_value);

                var grp_value= $('#grp_no_list_4').val();
                $('#final_grp').val(grp_value);

            }else if(parseInt(list_no)==5)
            {
                var prod_value= $('#pord_no_list_5').val();
                $('#final_prod').val(prod_value);

                var grp_value= $('#grp_no_list_5').val();
                $('#final_grp').val(grp_value);


            }


            $('#searchForm').submit();
            console.log($('#final_prod').val());
            console.log($('#final_grp').val());

        }
    



        $('#searchForm').submit(function() {
            var city_from = $('#departurelist_item').val();
            var city_to = $('#travelregionlist_item').val();
          
            var choose_date = $('#choose-date').val();
            var travelkind = $('.TravelKind_select').val();
            var date_NewArray = new Array();


            ///************ ensure_box
            var checked_box_value = $('#ensure').is(':checked');
            if (checked_box_value == true) {
                $('#search_is_ensure').val(1);

            } else {
                $('#search_is_ensure').val(0);
            }
            ///************ ensure_box

            ///************ tour_day
            var tour_day = $('.tour_day').children('.active').text();
            var final_tour_day_no;
            if(tour_day=="不限")
            {          
                final_tour_day_no = "GE1" ;
            
            }else{

           

               var tour_day_s = tour_day.substr(0, 1);
                

                if (tour_day_s == 4) {
                    final_tour_day_no = "LE" + tour_day_s;
                }
                else if (tour_day_s == 7) {

                   final_tour_day_no = "GE" + tour_day_s;
               } else if(tour_day_s == 5){
 
                   final_tour_day_no = "EQ" + tour_day_s;
               } else if(tour_day_s == 6){

                    final_tour_day_no = "EQ" + tour_day_s;
                }
            }
          
            $('#search_tour_day').val(final_tour_day_no);
            ///************ tour_day

            ///************stime
            var stime = $('.stime').children('.active').text();
           // var stime_NewArray = new Array();

            if(stime=="不限")
            {
                $('#search_stime_s').val("00:00");
                $('#search_stime_e').val("23:59");


            }else{
                var stime_NewArray = new Array();
                stime_NewArray = stime.split("-");

                if (stime_NewArray[1] == "24:00") {
                    stime_NewArray[1] = "23:59";
                }

                // y.substr(0, 1);
                $('#search_stime_s').val(stime_NewArray[0]);
                $('#search_stime_e').val(stime_NewArray[1]);
                console.log($('#search_stime_s').val());
                console.log($('#search_stime_e').val());
            
            }


            ///************stime

            ///************etime
            var etime = $('.etime').children('.active').text();
            //var etime_NewArray = new Array();

            if(etime=="不限")
            {
                $('#search_etime_s').val("00:00");
                $('#search_etime_e').val("23:59");


            }else{

                var etime_NewArray = new Array();
                etime_NewArray = etime.split("-");

                if (etime_NewArray[1] == "24:00")
                {
                    etime_NewArray[1] = "23:59";
                }

                // y.substr(0, 1);
                $('#search_etime_s').val(etime_NewArray[0]);
                $('#search_etime_e').val(etime_NewArray[1]);
                console.log($('#search_etime_s').val());
                console.log($('#search_etime_e').val());
            }
           
            ///************etime
            ///************order_type
            var current_type = $('.conditions .updown.active').children('span').attr("class");
            var current_id = $('.conditions .updown.active').attr("id");
            var final_order_type = "";
            if (current_id == "price")
            {
                if (current_type == "up") {
                    final_order_type = "PriceInc";
                }else
                {
                    final_order_type = "PriceDesc";
                }
            } else if (current_id == "day")
            {
                if (current_type == "up") {
                    final_order_type = "DayInc";
                } else {
                    final_order_type = "DayDesc";
                }


            } else
            {
                if (current_type == "up") {
                    final_order_type = "SdateInc";
                } else {
                    final_order_type = "SdateDesc";
                }
            }

            ///************order_type
            ///************page
            var current_page=$('.star-pager').find('.active').children('a').text();


            ///************page
            date_NewArray = choose_date.split("~");

            $('#research_page').val(current_page);
            $('#order_type_1').val(final_order_type);
            $('#search_city_from').val(city_from);
            $('#search_city_to').val(city_to);
            $('#search_choose_date_s').val(date_NewArray[0]);
            $('#search_choose_date_e').val(date_NewArray[1]);
            $('#search_travelkind').val(travelkind);

            console.log($('#research_page').val());
            console.log($('#order_type_1').val());
            console.log($('#search_choose_date_s').val());
            console.log($('#search_choose_date_e').val());
            //console.log($('#which_button').val());
            return true;
        });

        function tweak() {
            $('.searchCriteria').show()
        }

    </script>



}    


        @if (Model.grplist_result.rCode.Equals("0001"))
        {
        <!-- 手機版============================================================================= -->
        <div class="content content-white content-mobile">
            <div class="mobile-searchLine" >
                <a href="javascript:;" onclick="tweak()" title="" >
                    <i class="glyphicon glyphicon-search"></i>
                    @(grplist_city_from)–@(grplist_city_to)／出發區間：@grplist_s_data_s.ToString("yyyy/MM/dd(ddd)")~<br />
                    @grplist_s_data_e.ToString("yyyy/MM/dd(ddd)")
                </a>
            </div>

            @for (int i = 0; i < Model.grplist_result.Data.prod.Count; i = i + 1)
            {
                var item = Model.grplist_result.Data.prod[i];
                string qkk = Html.DisplayFor(modelitem => item.GrpList[0].QTY_KK).ToString();
                int number = i + 1;

                int qkk_d = int.Parse(qkk, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                DateTime s_date = DateTime.ParseExact(Html.DisplayFor(modelitem => item.GrpList[0].FlyList[0].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                DateTime e_date = DateTime.ParseExact(Html.DisplayFor(modelitem => item.GrpList[0].FlyList[1].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);

                TimeSpan different_s_tour = new TimeSpan(e_date.Ticks - s_date.Ticks);
                int final_day = different_s_tour.Days + 1;
                string price = Html.DisplayFor(modelitem => item.Price).ToString();
                int price_d = int.Parse(price, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
        <!-- 第一筆 -->
                <div class="star-searchResultsItem-mobile">
                    <h4>
                        <a title="">@Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.Prod_Name).ToString()))</a>
                    </h4>
                    <div class="row mb-10">
                        <div class="col-xs-6 star-searchResultsItem-mobile-img">
                            <img src="http://www.startravel.com.tw/@Html.DisplayFor(modelitem => item.Image_URL).ToString()">
                            <span>@(i + 1)</span>
                        </div>
                        <div class="col-xs-6 star-searchResultsItem-mobile-textR">
                            <h1>@final_day<small>天</small></h1>
                            <ul>
                                <li class="qkk_@(i + 1)">@qkk_d 人以上成行</li>
                                <li>送旅遊金</li>
                            </ul>
                        </div>
                    </div>
                    <div class="row mb-10">
                        <div class="col-xs-12 col-sm-12">
                            <div class="abgne-star-carousel">
                                <div class="star-btn">
                                    <a href="javascript:;" class="prev star-left0@(i + 1)" onclick="new_prev_list_function('0,@Html.DisplayFor(modelitem => number),@Html.DisplayFor(modelitem => item.GrpList.Count),0,0')">
                                        <i class="glyphicon glyphicon-chevron-left"></i>
                                    </a>
                                    <a href="javascript:;" class="next star-right0@(i + 1)" onclick="new_prev_list_function('0,@Html.DisplayFor(modelitem => number),@Html.DisplayFor(modelitem => item.GrpList.Count),1,0')">
                                        <i class="glyphicon glyphicon-chevron-right"></i>
                                    </a>
                                </div>
                                <div class="star-list-title">
                                    <div>
                                        @grplist_city_from 出發
                                    </div>
                                    <div>
                                        去程
                                    </div>
                                    <div>
                                        回程
                                    </div>
                                </div>
                                <div class="frame">
                                    <ul class="star-list0@(i+1) star-list">
                                        <!--選項區-->
                                        @{int j = 0;

                                        }
                                        @for (j = 0; j < item.GrpList.Count; j = j + 1)
                                        {
                                            var item_grplist = item.GrpList[j];
                                            string string_s_date = Html.DisplayFor(modelitem => item_grplist.S_DATE).ToString();
                                            DateTime current_day = DateTime.ParseExact(string_s_date.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                           // int int_QTY_KK = int.Parse(Html.DisplayFor(modelitem => item_grplist.QTY_KK).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                                            DateTime s_depart_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[0].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                            DateTime s_arrive_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[0].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                            string s_city_from = Html.DisplayFor(modelitem => item_grplist.FlyList[0].CITY_FROM_NAME).ToString();
                                            string s_city_to = Html.DisplayFor(modelitem => item_grplist.FlyList[0].CITY_TO_NAME).ToString();
                                            string s_air_name = Html.DisplayFor(modelitem => item_grplist.FlyList[0].AIR_NAME).ToString();
                                            string s_fly_no = Html.DisplayFor(modelitem => item_grplist.FlyList[0].FLY_NO).ToString();
                                            DateTime e_depart_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[1].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                            DateTime e_arrive_time = DateTime.ParseExact(Html.DisplayFor(modelitem => item_grplist.FlyList[1].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                            string e_city_from = Html.DisplayFor(modelitem => item_grplist.FlyList[1].CITY_FROM_NAME).ToString();
                                            string e_city_to = Html.DisplayFor(modelitem => item_grplist.FlyList[1].CITY_TO_NAME).ToString();
                                            string e_air_name = Html.DisplayFor(modelitem => item_grplist.FlyList[1].AIR_NAME).ToString();
                                            string e_fly_no = Html.DisplayFor(modelitem => item_grplist.FlyList[1].FLY_NO).ToString();


                                            int int_QTY_KK = int.Parse(Html.DisplayFor(modelitem => item_grplist.QTY_KK).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                                            int int_Price = int.Parse(Html.DisplayFor(modelitem => item_grplist.Price).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

                                            string qty_kk_s = int_QTY_KK.ToString("#,#");
                                            string Price_s = int_Price.ToString("#,#");
                                            qty_kk_s = qty_kk_s == "" ? "0" : qty_kk_s;
                                            Price_s = Price_s == "" ? "0" : Price_s;
                                            
                                            
                                            <li>
                                                <div class="text-purple text-bold">
                                                    <input type="text" style="display: none" id="every_pord_no_@(number)_@j" name="every_pord_no_@(number)_@j" value="@item_grplist.Prod_NO">
                                                    <input type="text" style="display: none" id="every_grp_no_@(number)_@j" name="every_grp_no_@(number)_@j" value="@item_grplist.GRP_NO">
                                                    <input type="text" style="display: none" id="every_qty_kk_@(number)_@j" name="every_qty_kk_@(number)_@j" value="@qty_kk_s">
                                                    <input type="text" style="display: none" id="every_price_@(number)_@j" name="every_price_@(number)_@j" value="@Price_s">
                                                    @{
                                                        if (int_QTY_KK > 0)
                                                        {
                                                            <a  title="">@current_day.ToString("MM/dd(ddd)")</a>  @:可報 @int_QTY_KK 位
                                                    if (item_grplist.DEPARTURE_FLAG.Equals("1"))
                                                            {
                                                                <a class="ensure" href="javascript:;" title="">保出</a>
                                                            }
                                                        }
                                                        else
                                                        {
                                                        <!--<a class="event lightboxOpen-control02" href="javascript:;" title="">活動<i class="glyphicon glyphicon-chevron-right"></i></a>-->
                                                            @: 關團
                                                }
                                                    }
                                                </div>
                                                <div>
                                                    @s_depart_time.ToString("HH:mm") @s_city_from/@s_arrive_time.ToString("HH:mm")@s_city_to  @s_air_name
                                                </div>
                                                <div>
                                                    @e_depart_time.ToString("HH:mm") @e_city_from/@e_arrive_time.ToString("HH:mm")@e_city_to  @e_air_name
                                                </div>
                                            </li>
                                                        }
                                        <!--選項區-->
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12">
                            <div class="star-searchResultsItem-mobile-date01">
                                <!-- 更多日期 -->
                                @for (int n = 0; n < item.GrpList.Count; n = n + 1)
                                {
                                    var item_grplist_s = item.GrpList[n];
                                    string string_s_date = Html.DisplayFor(modelitem => item_grplist_s.S_DATE).ToString();
                                    DateTime current_day = DateTime.ParseExact(string_s_date.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);

                                    if (n == (item.GrpList.Count - 1))
                                    {
                                        <a onclick="new_prev_list_function('1,@Html.DisplayFor(modelitem => number),0,0,@Html.DisplayFor(modelitem => n) ')" title="">@current_day.ToString("MM/dd(ddd)")</a>
                                    }
                                    else

                                    {
                                        <a onclick="new_prev_list_function('1,@Html.DisplayFor(modelitem => number),0,0,@Html.DisplayFor(modelitem => n)')" title="">@current_day.ToString("MM/dd(ddd)")</a>@:|
                            }
                                }
                            </div>
                            @if (item.GrpList.Count > 3)
                            {
                            <a  href="javascript:;" id="@(i+1)" title="" onclick="detail_button_click(this)">更多</a>
                            }
                          
                        </div>
                    </div>
                    <div class="row star-searchResultsItem-mobile-price">
                        <div class="col-xs-6">
                            <h2 class="text-orange final_price_@number">@price_d.ToString("#,#") <small>元起</small></h2>
                        </div>
                        <div class="col-xs-6">
                            <a class="star-searchResultsItem-mobile-viewItinerary" id="@(i+1)" onclick="detail_button_click(this)" title="">查看行程</a>
                        </div>
                    </div>
                </div>

                                                        }






            <div id="mobile-loadmore" class="mobile-loadmore">
                載入更多...
            </div>

        </div>
        <!-- 手機區塊結尾-->
        }


            <!-- footer======================================================================= -->
            <div class="footer">
                <!-- award -->
                <div class="footerAward">
                    <div class="star-container">
                        <ul>
                            <li>
                                <a href="javascript:;" title="">
                                    <img src="~/Content/images/award-01.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">
                                    <img src="~/Content/images/award-02.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">
                                    <img src="~/Content/images/award-03.png" alt="">
                                </a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">
                                    <img src="~/Content/images/award-04.png" alt="">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- footermenu -->
                <div class="footerMenu">
                    <div class="star-container">
                        <ul>
                            <li>
                                <a href="javascript:;" title="">關於燦星</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">交易安全</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">隱私權條款</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">FAQ</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">策略聯盟</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">菁英募集</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">企業商務</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">福委會</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">寫信給我們</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">網站導覽</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">陸客來台</a>
                            </li>
                            <li>
                                <a href="javascript:;" title="">防詐騙聲明</a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- footerContent -->
                <div class="footerContent">
                    <div class="star-container">
                        <div class="row">
                            <div class="col-xs-12 col-md-4">
                                <a class="footerPhone" href="tel:0281783000" title="">訂購諮詢專線：(02)8178-3000</a>
                            </div>
                            <div class="col-xs-12 col-md-4">
                                <a class="footerPhone" href="tel:024128686" title="">全台門市訂購專線：(02)412-8686</a>
                            </div>
                            <div class="col-xs-12 col-md-4">
                                <a class="footerPhone" href="tel:0227900550" title="">企業服務專線：(02)2790-0550</a>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-4">
                                <strong class="footerContentTitle">燦星國際旅行社股份有限公司</strong>
                                總公司：<a href="javascript:;" target="_blank">台北市內湖區堤頂大道一段331號4樓</a><br>
                                訂購諮詢電話：<a href="tel:0281783000">(02)8178-3000</a><br>
                                || 週六日/ 國定假日 AM09:00~PM19:00 ||<br>
                                || 平日 週一 ~ 週五 AM08:00~AM02:00 ||<br>
                                傳真電話：070-10168-965<br>
                                客服信箱：<a href="mailto:service@startravel.com.tw">service@startravel.com.tw</a>
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <strong class="footerContentTitle">全台服務據點</strong>
                                代表門市<br>
                                台北寧夏店 (02)2556-1226<br>
                                台北南京旗艦店 (02)6608-8155<br>
                                新北蘆洲門市 (02)2281-6076<br>
                                新北土城門市 (02)8261-6403<br>
                                桃園八德門市 (03)361-8368<br>
                                新竹竹科門市 (03)578-5377<br>
                                苗栗竹南門市 (037)550-545<br>
                                台中門市 (04)3600-6799<br>
                                台南永華店 (06)293-3200<br>
                                高雄門市 (07)969-6618
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <strong class="footerContentTitle">企業服務 </strong>
                                服務項目：獎勵旅遊、商務差旅、員工旅遊、自組一團、公家機關<br>
                                專線：(02)2790-0550、(02)81783000#8151<br>
                                信箱：mice01@startravel.com.tw <br>
                                週一~週五 AM9:00-PM18:00<br>
                                <br>
                                <strong class="footerContentTitle">同業聯絡</strong>
                                <a href="http://goo.gl/ZEItJe" title="" target="_blank">http://goo.gl/ZEItJe</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- footerCertification -->
                <div class="footerCertification">
                    <div class="star-container">
                        <ul>
                            <li>
                                <a class="footer-icon01" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon02" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon03" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon04" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon05" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon06" href="javascript:;" title="" target="_blank"></a>
                            </li>
                            <li>
                                <a class="footer-icon07" href="javascript:;" title="" target="_blank"></a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- footerCopyright -->
                <div class="footerCopyright">
                    <div class="star-container">
                        ‧代表人：陳彥君 ‧聯絡人：鐘長利  綜合旅行社‧交觀綜字第2136號‧旅行社品質保障協會100字第北1819號 © 燦星旅遊版權所有盜用必究　All Rights Reserved.
                    </div>
                </div>

            </div>












            <!-- footer-mobile=============================================================== -->
            <div class="footer-mobile">
                <div>
                    <span class="text-purple text-bold">訂購諮詢專線：(02)8178-3000</span>
                </div>
                <div class="bg-w">
                    燦星國際旅行社股份有限公司<br>
                    總公司：台北市內湖區堤頂大道一段331號4樓<br>
                    訂購諮詢電話：(02)8178-3000<br>
                    || 週六日/ 國定假日 AM09:00~PM19:00 ||<br>
                    || 平日 週一 ~ 週五 AM08:00~AM02:00 ||<br>
                    傳真電話：070-10168-965<br>
                    客服信箱：service@startravel.com.tw
                </div>
                <div>
                    <span class="text-purple text-bold">全台門市訂購專線：(02)412-8686</span>
                </div>
                <div class="bg-w">
                    <a href="javascript:;" title="">全台服務據點</a>
                </div>
                <div>
                    <span class="text-purple text-bold">企業服務專線：(02)2790-0550</span>
                </div>
                <div class="bg-w">
                    專線：<br>
                    (02)2790-0550<br>
                    (02)81783000#8151<br>
                    信箱：mice01@startravel.com.tw <br>
                    週一~週五 AM9:00-PM18:00
                </div>
                <div>
                    代表人：陳彥君 / 聯絡人：鐘長利<br>
                    綜合旅行社 / 交觀綜字第2136號 / 旅行社品質保障協會100字第北1819號<br>
                    © 燦星旅遊版權所有盜用必究 All Rights Reserved.
                </div>
            </div>







            <!-- gotoTop==================================================================== -->
            <div class="gotoTop">
                <a href="javascript:;" id="topBTN">
                    <img src="~/Content/images/gotoTop.png" alt="">
                </a>
            </div>






    </body>
</html>