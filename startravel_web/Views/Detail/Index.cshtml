<!DOCTYPE html>
@model startravel_web.Models.detail_view_return_data

@{
    Layout = null;
}
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")
@Scripts.Render("~/bundles/jquery-ui")
@Scripts.Render("~/bundles/star-ui")

@Scripts.Render("~/bundles/modernizr")
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>燦星旅遊-出國旅遊第一選擇，夢想般國外旅遊行程</title>
    <link rel="shortcut icon" href="~/Content/images/star-icon.png" />

    <link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="~/Content/jquery-ui.css">
    <link href="~/Content/main.css" rel="stylesheet" type="text/css">
    <link href="~/Content/HeaderFooter.css" rel="stylesheet" type="text/css">
    <link href="~/Content/step-css.css" rel="stylesheet" type="text/css">
    <link href="~/Content/style.css" rel="stylesheet" type="text/css">


    <!-- jQuery (Bootstrap 所有外掛均需要使用) -->
 

    <!-- HTML5 shim and Respond.js 讓 IE8 支援 HTML5 元素與媒體查詢 -->
    <!-- 警告：Respond.js 無法在 file:// 協定下運作 -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


    
</head>
<body>
@using (Html.BeginForm("detail_transfer", "Detail", FormMethod.Post, new { enctype = "multipart/form-data" , id="transferForm"}))
{
    <!-- header======================================================================= -->
    <div class="header-02">
        <div class="header-02-pc star-container">
            <div class="row">
                <div class="col-xs-12 col-sm-8 col-sm-push-4">
                    <div class="header-link">
                        <ul>
                            <li>
                                <a href="javascript:;" title="">會員登入</a> /
                                <a href="javascript:;" title="">註冊</a>
                            </li>
                            <li><a href="javascript:;" title="">查詢及付款</a></li>
                            <li><a href="javascript:;" title="">全台門市</a></li>
                            <li><a href="javascript:;" title="">企業專區</a></li>
                            <li><a href="javascript:;" title="">線上申訴</a></li>
                            <li><a href="javascript:;" title="">同業網站</a></li>
                            <li><a href="javascript:;" title=""><img src="~/Content/images/fb-icon.png" alt=""></a></li>
                            <li><a href="javascript:;" title=""><img src="~/Content/images/top-icon1.gif" alt=""></a></li>
                        </ul>
                    </div>
                    <div class="header-rainbow">
                        <img src="~/Content/images/rainbow.png" alt="">
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 col-sm-pull-8">
                    <a class="header-logo" href="http://www.startravel.com.tw/" title="">
                        <img src="~/Content/images/logo-text.png" alt="">
                    </a>
                </div>
            </div>
            <div class="header-02-menu">
                <img src="~/Content/images/header02-1.png" alt="">
                <a class="active" href="javascript:;" title="">團體旅遊</a>
                <a href="javascript:;" title="">自由行</a>
                <a href="javascript:;" title="">郵輪</a>
                <a href="javascript:;" title="">機票</a>
                <a href="javascript:;" title="">訂房</a>
                <img src="~/Content/images/header02-2.png" alt="">
                <a href="javascript:;" title="">旅遊</a>
                <a href="javascript:;" title="">機票</a>
                <a href="javascript:;" title="">高鐵訂房</a>
                <img src="~/Content/images/header02-3.png" alt="">
                <a href="javascript:;" title="">台中出發</a>
                <a href="javascript:;" title="">高雄出發</a>
                <a href="javascript:;" title="">票券</a>
                <a href="javascript:;" title="">簽證</a>
                <a href="javascript:;" title="">運動旅遊</a>
            </div>
        </div>



        <div class="header-02-mobile">
            <a href="javascript:;">
                <img class="img-responsive" src="~/Content/images/logo-text.png" alt="">
            </a>
            <nav class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                        <span class="sr-only">選單切換</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    團體旅遊
                </div>

                <!-- 手機隱藏選單區 -->
                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <!-- 左選單 -->
                    <ul class="nav navbar-nav">
                        <li>國外</li>
                        <li class="active"><a href="#">團體旅遊</a></li>
                        <li><a href="#">自由行</a></li>
                        <li><a href="#">郵輪</a></li>
                        <li><a href="#">機票</a></li>
                        <li><a href="#">訂房</a></li>
                        <li>國內</li>
                        <li><a href="#">旅遊</a></li>
                        <li><a href="#">機票</a></li>
                        <li><a href="#">高鐵訂房</a></li>
                        <li>更多</li>
                        <li><a href="#">台中出發</a></li>
                        <li><a href="#">高雄出發</a></li>
                        <li><a href="#">票券</a></li>
                        <li><a href="#">簽證</a></li>
                        <li><a href="#">運動旅遊</a></li>
                    </ul>
                    <hr>
                    <ul class="nav navbar-nav">
                        <li><a href="javascript:;" title="">會員登入</a></li>
                        <li><a href="javascript:;" title="">註冊</a></li>
                        <li><a href="javascript:;" title="">查詢及付款</a></li>
                        <li><a href="javascript:;" title="">全台門市</a></li>
                        <li><a href="javascript:;" title="">企業專區</a></li>
                        <li><a href="javascript:;" title="">線上申訴</a></li>
                        <li><a href="javascript:;" title="">同業網站</a></li>
                        <li><a href="javascript:;" title=""><img src="~/Content/images/fb-icon.png" alt=""></a></li>
                        <li><a href="javascript:;" title=""><img src="~/Content/images/top-icon1.gif" alt=""></a></li>
                    </ul>

                </div>
                <!-- 手機隱藏選單區結束 -->
            </nav>


        </div>
    </div>



    <!-- 內容區塊===================================================================== -->
 
    <div class="content content-white">
        <div class="star-container">
            <!-- 麵包屑 -->
            <div class="path hidden-xs">
                <ol class="breadcrumb">
                    <li>
                        <a href="#">首頁</a>
                    </li>
                    <li>
                        <a href="#">國外團體旅遊</a>
                    </li>
                    <li>
                      
                        <a href="#">@Html.DisplayFor(model => model.grpproductdetail_result.Data.CAT1NAME).ToString()</a>
                    </li>

                    <li>
                     
                        <a href="#">@Html.DisplayFor(model => model.grpproductdetail_result.Data.CAT2NAME).ToString()</a>
                    </li>
                    
                 
                    <li class="active">@Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NAME).ToString()))</li>
                </ol>
            </div>


            @{
               // string qty_kk = Html.DisplayFor(model => model.grpproductdetail_result.Data.QTY_KK).ToString();
                string price = Html.DisplayFor(model => model.grpproductdetail_result.Data.PRICE).ToString();
                string pre_amt = Html.DisplayFor(model => model.grpproductdetail_result.Data.PRE_AMT).ToString();

                //int qty_kk_d = int.Parse(qty_kk, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
              //  int qty_kk_d = Convert.ToInt32(qty_kk, 10);
                int qty_kk_d = Decimal.ToInt32(Model.grpproductdetail_result.Data.QTY_KK);
                if (qty_kk_d < 0)
                {
                    qty_kk_d = 0;
                }
                
                int price_d = int.Parse(price, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                int pre_amt_d = int.Parse(pre_amt, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                }

            <!-- 行程標題照片介紹 -->
            <div class="travelInformation">
                <div class="row">
                    <!-- 左邊照片 -->
                    <div class="col-xs-12 col-sm-6 mb-10">
                        <img class="travelInformation-img" src="http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_PIC)">
                    </div>

                    <!-- 右邊文字 -->
                    <div class="col-xs-12 col-sm-6">
                        <div class="groupNum">
                            團號：@Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NO).ToString()))
                            <div class="shareIcon hidden-xs">
                                <a class="icon-fb" href="javascript:;" title=""></a>
                                <a class="icon-line" href="javascript:;" title=""></a>
                                <a class="icon-print" href="javascript:;" title=""></a>
                            </div>
                        </div>
                        

                        <div class="travelTitle">
                            @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NAME).ToString()))
                        </div>
                        
                          <p>                              
                              @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_DESC4).ToString()))
                           </p>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6">
                                <span class="text-18 text-orange text-bold">只剩 @qty_kk_d.ToString()  位</span><br>
                                <span class="travel-price">@price_d.ToString("#,#") </span> 元起
                                <a class="price-info lightboxOpen-control01" href="javascript:;">價格說明</a>
                                <p class="text-gray mt-10">
                                    訂金：@pre_amt_d.ToString("#,#") <br>
                                </p>
                            </div>
                            <div class="col-xs-12 col-sm-6">
                                <input type="button" class="signUpBtn" onclick="signupbtn_click()" title="" value="立即報名" />
                                                                  
                            </div>
                        </div>

                    </div>
                </div>
                <div class="travelInformation-more-mobile">
                    <a href="javascript:;" title="">看更多</a>
                </div>
            </div>
         
           
                
               @Html.HiddenFor(model =>model.grpproductdetail_result.Data.PROD_NO )
               @Html.HiddenFor(model => model.grpproductdetail_result.Data.GRP_NO)
  
            <input type="hidden" id="prod_no" name="prod_no" value="@Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NO).ToString()">
            <input type="hidden" id="grp_no" name="grp_no" value="@Html.DisplayFor(model => model.grpproductdetail_result.Data.GRP_NO).ToString()">
            <input type="hidden" id="action_temp" name="action_temp" value="">
            <input type="hidden" id="window_open" name="window_open" value="0">
            

            @{
                string min_tourer = Html.DisplayFor(model => model.grpproductdetail_result.Data.MIN_TOURER).ToString();
                int min_tourer_d = int.Parse(min_tourer, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

                int transfer_all_count = Model.grpproductdetail_result.Data.TrafficList.Count;
                int transfer_times_half = transfer_all_count / 2;
                int transfer_times = transfer_times_half - 1;

                DateTime igrptraffic_s = DateTime.ParseExact( Model.grpproductdetail_result.Data.TrafficList[0].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                DateTime igrptraffic_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[transfer_times_half].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                string igrptraffic_ss = igrptraffic_s.ToString("yyyy/MM/dd(ddd)");
                igrptraffic_ss = igrptraffic_ss.Replace("週", "");
                string igrptraffic_es = igrptraffic_e.ToString("yyyy/MM/dd(ddd)");
                igrptraffic_es = igrptraffic_es.Replace("週", "");
            }

            <!-- 行程3點 -->
            <div class="travel-3block">
                <div class="row">
                    <div class="col-xs-12 col-sm-4">
                        <div class="travel-3block-img">
                            <img class="img-responsive" src="~/Content/images/icon-calendar.png" alt="">
                        </div>
                        <div class="travel-3block-text mt-20">
                            出發：@igrptraffic_ss<br>
                            回程：@igrptraffic_es
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <div class="travel-3block-img">
                            <img class="img-responsive" src="~/Content/images/icon-location.png" alt="">
                        </div>
                        <div class="travel-3block-text mt-20">
                              @Model.grpproductdetail_result.Data.CITY_TO_NAME<br>
                            <a class="price-info" href="javascript:;">看更多相關行程</a>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <div class="travel-3block-img">
                            <img class="img-responsive" src="~/Content/images/icon-group.png" alt="">
                        </div>
                        <div class="travel-3block-text mt-10">
                            ● @min_tourer_d.ToString() 人以上成行<br>
                            ● 送旅遊金<br>
                        </div>
                    </div>
                </div>
            </div>




            <!--get calendar info-->
            @{
                DateTime s_month = DateTime.ParseExact(Html.DisplayFor(model => model.grpcalendar_result.Data.search_s_month).ToString(), "yyyyMM", System.Globalization.CultureInfo.InvariantCulture);
                DateTime e_month = DateTime.ParseExact(Html.DisplayFor(model => model.grpcalendar_result.Data.search_e_month).ToString(), "yyyyMM", System.Globalization.CultureInfo.InvariantCulture);
                // DateTime s_month = DateTime.ParseExact("201712", "yyyyMM", System.Globalization.CultureInfo.InvariantCulture);
                //DateTime s_month_first_d = s_month;
                string s_month_first_d = s_month.DayOfWeek.ToString("d");
                string e_month_first_d = e_month.DayOfWeek.ToString("d");
                DateTime s_current_day = DateTime.ParseExact(s_month.ToString("yyyyMMdd"), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                DateTime m_current_day = DateTime.ParseExact(s_month.ToString("yyyyMMdd"), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture); //for mobile
                DateTime e_current_day = DateTime.ParseExact(e_month.ToString("yyyyMMdd"), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);

                int s_month_first_d_int = Int32.Parse(s_month_first_d);
                int e_month_first_d_int = Int32.Parse(e_month_first_d);
                int s_month_days = DateTime.DaysInMonth(s_month.Year, s_month.Month);
                int e_month_days = DateTime.DaysInMonth(e_month.Year, e_month.Month);
                int date_arrery_index = 0;

                int grp_date_number = 0;
                grp_date_number = Model.grpcalendar_result.Data.grp_date.Count;
   
                
                DateTime s_month_next=s_month.AddMonths(1);
                DateTime s_month_prev=s_month.AddMonths(-1);
           }



            <!-- 行程日曆 -->
            <div class="travel-calendar-btn">
                <a class="travel-calendar-open" href="javascript:;" title="">
                    <img src="~/Content/images/moreDateBtn.png" alt="">
                    <span>查看更多出發日期</span>
                </a>
            </div>
            <div class="travel-calendar">
                <div class="row">
                    <div class="col-xs-12 col-md-6">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th colspan="7" class="month">
                                            <a class="month-prev" href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpproductdetail_result.Data.GRP_NO&window_open=1&s_date=@s_month_prev.ToString("yyyyMMdd")" title=" ">
                                                <i class=" glyphicon glyphicon-chevron-left" id="date-1-go-back">
                                                </i>
                                            </a>
                                            <span id="tb-1-h">@s_month.GetDateTimeFormats('y')[0].ToString()</span>
                                            <a class="month-next hidden-lg hidden-md" href="" title="">
                                                <i class="glyphicon glyphicon-chevron-right" id="date-1-go-next"></i>
                                            </a>
                                        </th>
                                    </tr>
                                    <tr class="hidden-xs">
                                        <th style="width:14.28571%">日</th>
                                        <th style="width:14.28571%">一</th>
                                        <th style="width:14.28571%">二</th>
                                        <th style="width:14.28571%">三</th>
                                        <th style="width:14.28571%">四</th>
                                        <th style="width:14.28571%">五</th>
                                        <th style="width:14.28571%">六</th>
                                    </tr>
                                </thead>
                                <tbody class="hidden-xs">
                                    @{ 
                                        int date = 0;
                                    }
                                   @{
                                       int i = 0; int j = 0;
                                       int start_flag = 0;
                                       int date_i = 0;

                                       for (i = 0; i < 6; i = i + 1)
                                       {
                                            <tr>
                                                @for (j = 0; j < 7; j = j + 1)
{
    if (start_flag == 0)
    {
        if (j == s_month_first_d_int)
        {
            date_i = i * 7 + (j + 1) - s_month_first_d_int;
            string current_day_s = s_current_day.ToString("yyyyMMdd");

            if (date_arrery_index < grp_date_number)
            {
                if (current_day_s.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                {
                    string price_grp = Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Price).ToString();
                    int price_grp_i = int.Parse(price_grp, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                    // int qty_kk_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk).ToString(), 10);
                    //int qty_hl_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl).ToString(), 10);
                    int qty_kk_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk);
                    int qty_hl_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl);

                    if (qty_kk_i < 0)
                    {
                        qty_kk_i = 0;
                    }

                    <td class="date-@(i * 7 + (j + 1))" data-active="active" data-select="@(Model.grpproductdetail_result.Data.S_DATE == current_day_s? "select": "")">
                        <div class="travel-calendar-date">
                            <a class="date active">@date_i</a>
                            @if (qty_kk_i == 0 && qty_hl_i <= 0) {
                                <span class="price">@price_grp_i.ToString("#,#") </span>
                            } else {
                                <a href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Grp_no&window_open=1&s_date=@s_current_day.ToString("yyyyMMdd")" class="price">@price_grp_i.ToString("#,#") </a>
                            }
                            @if (Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp_count).ToString().Equals("1"))
                            {
                                if (qty_kk_i == 0)
                                {

                                    if (qty_hl_i > 0)
                                    {
                                        <span class="quota text-green">可候補</span>
                                    }
                                    else
                                    {
                                        <span class="quota text-green">關團</span>
                                    }
                                }
                                else
                                {
                                    <span class="quota text-orange">僅剩@(qty_kk_i.ToString())位</span>
                                }
                            }
                            else
                            {
                                <a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="@Model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date">看更多團</a>
                            }
                        </div>
                    </td>

                            date_arrery_index = date_arrery_index + 1;
                            if (date_arrery_index == grp_date_number)
                            {
                                date_arrery_index = grp_date_number - 1;
                            }

                } // if (current_day_s.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                else
                {
                                                                <td class="date-@(i * 7 + ( j + 1 ))">
                                                                <div class="travel-calendar-date">
                                                                     <span class="date">@date_i</span>
                                                               </div>
                                                             </td>
                                                            }
                                                              }
                                                            else  //  if (date_arrery_index < grp_date_number)
                                                            {
                                                                <td class="date-@(i * 7 + ( j + 1 ))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i</span>
                                                                    </div>
                                                                </td>
                                                            }
                                                            
                                                            
                                                            
                                                            start_flag = 1;
                                                            s_current_day = s_current_day.AddDays(1);
                                                            
                                                          
                                                        }
                                                        else // if (j == s_month_first_d_int)
                                                        {
                                                            <td class="date-@(i * 7 + ( j + 1 ))">
                                                                <div class="travel-calendar-date">
                                                                     <span class="date"> </span>
                                                               </div>
                                                             </td>
                                                        }
                                                    }
                                                    else  //if((start_flag)
                                                    {
                                                        date_i = i * 7 + (j + 1) - s_month_first_d_int;
                                                        string current_day_s = s_current_day.ToString("yyyyMMdd");

                                                        if (date_i < s_month_days + 1)
                                                        {
                                                            if (date_arrery_index < grp_date_number)
                                                            {
                                                                if (current_day_s.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                                                                {

                                                                    string price_grp = Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Price).ToString();
                                                                    int price_grp_i = int.Parse(price_grp, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                                                                    // int qty_kk_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk).ToString(), 10);
                                                                    //int qty_hl_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl).ToString(), 10);
                                                                    int qty_kk_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk);
                                                                    int qty_hl_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl);
                                                                    if (qty_kk_i < 0)
                                                                    {
                                                                        qty_kk_i = 0;
                                                                    }

                                                                    <td class="date-@(i * 7 + (j + 1))" data-active="active" data-select="@(Model.grpproductdetail_result.Data.S_DATE == current_day_s? "select": "")">
                                                                        <div class="travel-calendar-date">
                                                                            <a  class=" date active">@date_i</a>
                                                                            @if (qty_kk_i == 0 && qty_hl_i <= 0) {
                                                                                <span class="price">@price_grp_i.ToString("#,#") </span>
                                                                            } else {
                                                                                <a  href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Grp_no&window_open=1&s_date=@s_current_day.ToString("yyyyMMdd")" class="price">@price_grp_i.ToString("#,#") </a>

                                                                            }
                                                                            @if (Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp_count).ToString().Equals("1"))
                                                                            {
                                                                                if (qty_kk_i == 0)
                                                                                {

                                                                                    if (qty_hl_i > 0)
                                                                                    {
                                                                                        <span class="quota text-green">可候補</span>
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <span class="quota text-green">關團</span>
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    <span class="quota text-orange">僅剩@(qty_kk_i.ToString())位</span>
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                <a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="@Model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date">看更多團</a>
                                                                            }
                                                                        </div>
                                                                    </td>


                                                                            date_arrery_index = date_arrery_index + 1;
                                                                            if (date_arrery_index == grp_date_number)
                                                                            {
                                                                                date_arrery_index = grp_date_number - 1;
                                                                            }
                                                                }
                                                                else  //  if (current_day_s.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                                                                {
                                                                <td class="date-@(i * 7 + ( j + 1 ))">
                                                                <div class="travel-calendar-date">
                                                                     <span class="date">@date_i</span>
                                                               </div>
                                                                </td>
                                                                }
                                                            }
                                                            else  //  if (date_arrery_index < grp_date_number)
                                                            {
                                                                <td class="date-@(i * 7 + ( j + 1 ))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i</span>
                                                                    </div>
                                                                </td>
                                                            }


                                                            s_current_day = s_current_day.AddDays(1);
                                                        }
                                                        else // if (date_i < s_month_days + 1)
                                                        {

                                                              <td class="date-@(i * 7 + ( j + 1 ))">
                                                                <div class="travel-calendar-date">
                                                                     <span class="date"> </span>
                                                               </div>
                                                             </td>
                                                        }

                                                    }

                                                }
                                            </tr>
                                       }


                                      }
                              </tbody>
                            </table>
                            <!-- 自製區快 非f2e list-style(custom- style.css)-->
                            <div class="content-mobile">
                                @{ date_arrery_index = 0; }
                                @for (i = 1; i <= s_month_days; i++)
                                {
                                    if (date_arrery_index < grp_date_number)
                                    {
                                        if (m_current_day.ToString("yyyyMMdd").Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                                        {

                                            string price_grp = Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Price).ToString();
                                            int price_grp_i = int.Parse(price_grp, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                                           // int qty_kk_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk).ToString(), 10);
                                            //int qty_hl_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl).ToString(), 10);
                                            int qty_kk_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk);
                                            int qty_hl_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl);
                                            if (qty_kk_i < 0)
                                            {
                                                qty_kk_i = 0;
                                            }

                                            <div class="list-style">
                                                <a href="javascript:;" class="date" >@i 日</a>
                                                @if (qty_kk_i==0 &&qty_hl_i <= 0 ) {
                                                    <span class="price">@price_grp_i.ToString("#,#")</span>
                                                    
                                                } else {
                                                    <a onclick="calendar_number_click('@(Model.grpcalendar_result.Data.Prod_no),@(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Grp_no)')" class="price">@price_grp_i.ToString("#,#")</a>

                                                }
                                                <div class="float-right">
                                                    @if (Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp_count).ToString().Equals("1"))
                                                    {
                                                           if (qty_kk_i==0)
                                                           {                      
                                                                if(qty_hl_i>0)
                                                                { 
                                                                    <span class="quota text-green">可候補</span>
                                                                }
                                                                 else
                                                                 {
                                                                    <span class="quota text-green">關團</span>
                                                                 }
                                                            }
                                                            else
                                                            {
                                                               <span class="quota text-orange">僅剩@(qty_kk_i.ToString())位</span>
                                                            }
                                                    }
                                                    else
                                                    {
                                                        <a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="@Model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date">看更多團</a>
                                                    }
                                                </div>
                                            </div>
                                                    date_arrery_index = date_arrery_index + 1;
                                                    if (date_arrery_index == grp_date_number)
                                                    {
                                                        date_arrery_index = grp_date_number - 1;
                                                    }
                                                               
                                        }
                                    }
                                    m_current_day = m_current_day.AddDays(1);
                                }
                            </div>
                        </div>
                    </div>





                    <div class="col-xs-12 col-md-6 hidden-xs hidden-sm">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th colspan="7" class="month">
                                            <a class="month-prev hidden-lg hidden-md hidden-sm" href="javascript:;" title="">
                                                <i class="glyphicon glyphicon-chevron-left" id="date-2-go-back"></i>
                                            </a>
                                            <span id="tb-2-h">@e_month.GetDateTimeFormats('y')[0].ToString()</span>
                                            <a class="month-next" href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpproductdetail_result.Data.GRP_NO&window_open=1&s_date=@s_month_next.ToString("yyyyMMdd")" title="">
                                                <i class="glyphicon glyphicon-chevron-right" id="date-2-go-next"></i>
                                            </a>
                                        </th>
                                    </tr>
                                    <tr>
                                        <th style="width:14.28571%">日</th>
                                        <th style="width:14.28571%">一</th>
                                        <th style="width:14.28571%">二</th>
                                        <th style="width:14.28571%">三</th>
                                        <th style="width:14.28571%">四</th>
                                        <th style="width:14.28571%">五</th>
                                        <th style="width:14.28571%">六</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @{
                                        i = 0;
                                        j = 0;
                                        int start_flag_e = 0;
                                        int date_i_e = 0;

                                        for (i = 0; i < 6; i = i + 1)
                                        {
                                            <tr>
                                                @for (j = 0; j < 7; j = j + 1)
{
    if (start_flag_e == 0)
    {
        if (j == e_month_first_d_int)
        {
            date_i_e = i * 7 + (j + 1) - e_month_first_d_int;
            string current_day_e = e_current_day.ToString("yyyyMMdd");

            if (date_arrery_index < grp_date_number)
            {
                if (current_day_e.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                {
                    string price_grp = Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Price).ToString();
                    int price_grp_i = int.Parse(price_grp, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                    //int qty_kk_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk).ToString(), 10);
                    //int qty_hl_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl).ToString(), 10);
                    int qty_kk_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk);
                    int qty_hl_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl);
                    if (qty_kk_i < 0)
                    {
                        qty_kk_i = 0;
                    }

                    <td class="date-@(i * 7 + (j + 1))" data-active="active" data-select="@(Model.grpproductdetail_result.Data.S_DATE == current_day_e ? "select" : "")">
                        <div class="travel-calendar-date">
                            <a class=" date active">@date_i</a>
                            @if (qty_kk_i == 0 && qty_hl_i <= 0) {
                                <span class="price">@price_grp_i.ToString("#,#") </span>

                            } else {
                                <a  href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Grp_no&window_open=1&s_date=@current_day_e " class="price">@price_grp_i.ToString("#,#") </a>

                            }
                            @if (Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp_count).ToString().Equals("1"))
                            {
                                if (qty_kk_i == 0)
                                {
                                    if (qty_hl_i > 0)
                                    {
                                        <span class="quota text-green">可候補</span>
                                    }
                                    else
                                    {
                                        <span class="quota text-green">關團</span>
                                    }
                                }
                                else
                                {
                                    <span class="quota text-orange">僅剩@(qty_kk_i.ToString())位</span>
                                }
                            }
                            else
                            {
                                <a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="@Model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date">看更多團</a>
                            }
                        </div>
                    </td>


                            date_arrery_index = date_arrery_index + 1;
                            if (date_arrery_index == grp_date_number)
                            {
                                date_arrery_index = grp_date_number - 1;
                            }


                }
                else// if (current_day_e.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                {
                                                                <td class="date-@(i * 7 + (j + 1))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i_e</span>
                                                                    </div>
                                                                </td>
                                                            }
                                                            
                                                            }
                                                            else  //  if (date_arrery_index < grp_date_number)
                                                            {
                                                                <td class="date-@(i * 7 + ( j + 1 ))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i</span>
                                                                    </div>
                                                                </td>
                                                            }

                                                            start_flag_e = 1;
                                                            e_current_day = e_current_day.AddDays(1);

                                                           //   }
                                                           
                                                        }
                                                        else //if (j == e_month_first_d_int)
                                                        {
                                                            <td class="date-@(i * 7 + (j + 1))">
                                                                <div class="travel-calendar-date">
                                                                    <span class="date"> </span>
                                                                </div>
                                                            </td>
                                                        }

    }
    else  // if (start_flag_e == 0)
    {
        date_i_e = i * 7 + (j + 1) - e_month_first_d_int;
        string current_day_e = e_current_day.ToString("yyyyMMdd");

        if (date_i_e < e_month_days + 1)
        {
            if (date_arrery_index < grp_date_number)
            {
                if (current_day_e.Equals(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date).ToString()))
                {
                    string price_grp = Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Price).ToString();
                    int price_grp_i = int.Parse(price_grp, System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);
                    //int qty_kk_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk).ToString(), 10);
                    //int qty_hl_i = Convert.ToInt32(Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl).ToString(), 10);
                    int qty_kk_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_kk);
                    int qty_hl_i = Decimal.ToInt32(Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Qty_hl);
                    if (qty_kk_i < 0)
                    {
                        qty_kk_i = 0;
                    }
                    <td class="date-@(i * 7 + (j + 1))" data-active="active" data-select="@(Model.grpproductdetail_result.Data.S_DATE == current_day_e? "select": "")">
                        <div class="travel-calendar-date">
                            <a class=" date active">@date_i_e</a>
                            @if (qty_kk_i == 0 && qty_hl_i <= 0) {
                                <span class="price">@price_grp_i.ToString("#,#") </span>

                            } else {
                                <a  href="?prod_no=@Model.grpproductdetail_result.Data.PROD_NO&grp_no=@Model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp[0].Grp_no&window_open=1&s_date=@current_day_e" class="price">@price_grp_i.ToString("#,#") </a>

                            }
                            @if (Html.DisplayFor(model => model.grpcalendar_result.Data.grp_date[date_arrery_index].Grp_count).ToString().Equals("1"))
                            {
                                if (qty_kk_i == 0)
                                {
                                    if (qty_hl_i > 0)
                                    {
                                        <span class="quota text-green">可候補</span>
                                    }
                                    else
                                    {
                                        <span class="quota text-green">關團</span>
                                    }
                                }
                                else
                                {
                                    <span class="quota text-orange">僅剩@(qty_kk_i.ToString())位</span>
                                }
                            }
                            else
                            {
                                <a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="@Model.grpcalendar_result.Data.grp_date[date_arrery_index].S_date">看更多團</a>
                            }
                        </div>
                    </td>

                            date_arrery_index = date_arrery_index + 1;
                            if (date_arrery_index == grp_date_number)
                            {
                                date_arrery_index = grp_date_number - 1;
                            }


                }
                else
                {
                                                                <td class="date-@(i * 7 + (j + 1))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i_e</span>
                                                                    </div>
                                                                 </td>
                                                                }
                                                            }
                                                            else
                                                            {
                                                                <td class="date-@(i * 7 + (j + 1))">
                                                                    <div class="travel-calendar-date">
                                                                        <span class="date">@date_i_e</span>
                                                                    </div>
                                                                 </td>
                                                            }


                                                            e_current_day = e_current_day.AddDays(1);
                                                        }
                                                        else
                                                        {

                                                            <td class="date-@(i * 7 + (j + 1))">
                                                                <div class="travel-calendar-date">
                                                                    <span class="date"> </span>
                                                                </div>
                                                            </td>
                                                        }

                                                    }

                                                }
                                            </tr>
                                        }


                                    }
                                </tbody>                           
                            </table>
                        </div>
                    </div>
                </div>
                <br>
                <div class="travel-calendar-close">
                    <a class="travel-calendar-close-btn" href="javascript:;" title="">
                        收合月曆<span></span>
                    </a>
                </div>
            </div>
            <input type="hidden" id="more_grp_no" name="more_grp_no" value="">
            <script>
    let get = parseInt('@(Model.window_open)')
    if (!isNaN(get)) {
        $('.travel-calendar-open').hide();
        $('.travel-calendar').fadeIn();
    }
    /* Date change month*/

    function autoChangeYearDate(yaer, month) {
        if (month<=0)
            return [yaer-1, 12]
        if (month > 12)
            return [yaer+1, 1]

        return [yaer, month]
    }

    function findGrpData(date, grpData) {
        let data = grpData.filter((data) => data.S_date==date)

        if(data.length)
            return data[0].Grp

        return []
    }
    function updateMobilDate(data, date) {
        let dateStr = `${date[0]}${format(date[1])}`
        $('.content-mobile').html("")
        console.log(data)
        data.forEach(function (val) {
            console.log(val.S_date, dateStr,val.S_date.includes(dateStr))
            console.log(val.Grp)
            if (val.S_date.includes(dateStr)) {
                let ele = $(`<div class="list-style"><span class="date" onclick="calendar_number_click('@Model.grpproductdetail_result.Data.PROD_NO,${val.Grp[0].Grp_no}')">${val.S_date.replace(dateStr,"")} 日</span>${val.Grp[0].Price}<div class="float-right">${val.Grp.length>1?`<a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="${val.S_date}">看更多團</a>`:""}${val.Grp[0].Qty_kk==0&&val.Grp[0].Qty_hl>0?`<span class="quota text-green">可候補</span>`:``}${val.Grp[0].Qty_kk<=0?`<span class='quota text-green'>關團</span>`:`<span class="quota text-orange">僅剩 ${val.Grp[0].Qty_kk}位</span>`}</div></div>`)
                if(val.Qty_kk == 0 && val.Qty_hl <= 0) {
                    $(ele).prop('onclick', null)
                }
                $('.content-mobile').append(ele)
            }

            })
                    }

                function updateFullDate(data, date) {
                    let table1 = $('.table-responsive').eq(0)
                    let table2 = $('.table-responsive').eq(1)
                    let nextDate = autoChangeYearDate(date[0], date[1]+1)
                    let start1 = new Date(date.join("/")+"/1").getDay()
                    let start2 = new Date(nextDate.join("/")+"/1").getDay()
                    let end1 = new Date(date[0], date[1], 0).getDate()
                    let end2 = new Date(nextDate[0], nextDate[1], 0).getDate()
                    updateMobilDate( data.Data.grp_date, date)
                    table1.find('tbody td').each(function() {
                        let day = parseInt($(this).attr("class").replace("date-", "")) - start1
                        if (day <= end1 && day > 0){
                            let date_test=date[0];

                            let date_data = findGrpData(`${date[0]}${format(date[1])}${format(day)}`, data.Data.grp_date)
                            //  console.log(`${date[0]}${format(date[1])}${format(day)}`)
                            let dateString = date[0] + '' + format(date[1]) + format(day)
                            if (date_data.length) {
                                let dd = date_data[0]
                                $(this).attr('data-active', 'active').html(`<span class="date active">${day}</span><span onclick="calendar_number_click('@Model.grpproductdetail_result.Data.PROD_NO,${dd.Grp_no}')" class="price">${dd.Price}</span>${dd.Qty_kk==0&&dd.Qty_hl>0?`<span class="quota text-green">可候補</span>`:""}${dd.Qty_kk<=0?"<span class='quota text-green'>關團</span>":`<span class="quota text-orange">僅剩 ${dd.Qty_kk}</span>`}${date_data.length>1?`<a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="${ date_data.S_date}">看更多團</a>`:""}`)
                                if (dd.Qty_kk == 0 && dd.Qty_hl <= 0)
                                    $(this).find('.price').prop('onclick', null)
                            }
                            else {
                                $(this).attr('data-active', '').html(`<span class="date ">${day}</span>`)
                            }
                        }
                    else
                            $(this).attr('data-active', '').html("")
                })
                    table2.find('tbody td').each(function() {
                        let day = parseInt($(this).attr("class").replace("date-", "")) - start2
                        if (day <= end2 && day > 0){
                            let date_data = findGrpData(`${nextDate[0]}${format(nextDate[1])}${format(day)}`, data.Data.grp_date)
                                 let dateString = nextDate[0]+ '' + format(nextDate[1]) + format(day)
                            if (date_data.length) {
                                let dd = date_data[0]
                                $(this).attr('data-active', 'active').html(`<span class="date active">${day}</span><span onclick="calendar_number_click('@Model.grpproductdetail_result.Data.PROD_NO,${dd.Grp_no}')" class="price">${dd.Price}</span>${dd.Qty_kk==0&&dd.Qty_hl>0?`<span class="quota text-green">可候補</span>`:""}${dd.Qty_kk<=0?`<span class="quota text-green">關團</span>`:`<span class="quota text-orange">僅剩 ${dd.Qty_kk}</span>`}${date_data.length>1?`<a href="javascript:;" class="more lightbox-moreGroup-open" onclick="more_get_grp_no(this)" id="${date_data.S_date}">看更多團</a>`:""}`)
                                if (dd.Qty_kk == 0 && dd.Qty_hl <= 0)
                                    $(this).find('.price').prop('onclick', null)
                                }
                            else {
                                $(this).attr('data-active', '').html(`<span class="date ">${day}</span>`)
                            }
                        }
                    else
                            $(this).attr('data-active', '').html("")
                })
                 $('.lightbox-moreGroup-open').unbind().bind('click', more_lightBox);
    }

                function updateHeader(year, month) {
                    let date_1 = autoChangeYearDate(year, month)
                    let date_2 = autoChangeYearDate(year, month + 1)
                    $('#tb-1-h').text(`${date_1[0]}年${date_1[1]}月`)
                    $('#tb-2-h').text(`${date_2[0]}年${date_2[1]}月`)
                    $('td[data-select=select]').attr('data-select', '')
    }

                function format(num) {
                    return num<10 ? "0" + num: num
                }

                function getDate(date) {
                    let lastDate = autoChangeYearDate(date[0], date[1])
                    let nextDate = autoChangeYearDate(date[0], date[1]+2)

                    return fetch(`Detail/calendar_reset?prod_no=@(Model.grpproductdetail_result.Data.PROD_NO)&s_month=${lastDate[0]}${format(lastDate[1])}&e_month=${nextDate[0]}${format(nextDate[1])}`, {
                            method: 'GET'
    })
                    .then(function(response) {
                        return response.json();
                        })

    }

                $(document).ready(() => {
                    $('.lightbox-moreGroup-open').bind('click', more_lightBox);
                    let nowYear = new Date("@igrptraffic_s.ToString("yyyy/MM")").getFullYear()
                    let nowMonth = new Date("@igrptraffic_s.ToString("yyyy/MM")").getMonth() + 1

                    console.log(nowYear,nowMonth)

                    $('#date-1-go-back').click((e) => {
                        e.preventDefault();
                        let changedDate = autoChangeYearDate(nowYear, nowMonth-1)
                        nowYear = changedDate[0]
                        nowMonth = changedDate[1]
                        updateHeader(nowYear, nowMonth)
                        getDate(changedDate).then((res) => {
                            updateFullDate(res, autoChangeYearDate(nowYear, nowMonth))
                        })
                        console.log(nowYear, nowMonth)
                    })
                    $('#date-1-go-back').parent().click((e) =>e.preventDefault())
                    $('#date-2-go-next').parent().click((e) =>e.preventDefault())
                    $('#date-1-go-next').click(function(e) {
                        e.preventDefault();
                        let changedDate = autoChangeYearDate(nowYear, nowMonth+1)
                        nowYear = changedDate[0]
                        nowMonth = changedDate[1]
                        updateHeader(nowYear, nowMonth)
                        getDate(changedDate).then((res) => {
                            updateFullDate(res, autoChangeYearDate(nowYear, nowMonth))
                        })
                    })

                    $('#date-2-go-next').click(() => {
                        let changedDate = autoChangeYearDate(nowYear, nowMonth+1)
                        nowYear = changedDate[0]
                        nowMonth = changedDate[1]
                        updateHeader(nowYear, nowMonth)
                        getDate(changedDate).then((res) => {
                            updateFullDate(res, autoChangeYearDate(nowYear, nowMonth))
                         })
                        console.log(nowYear, nowMonth)
                    })
                })

                function more_lightBox () {
                     $('.lightbox-moreGroup').fadeIn();
                      var grp_s_date= $("#more_grp_no").val();
                          console.log(grp_s_date);
                     $.ajax({
                                       url: 'Detail/more_lightingbox_click?prod_no=@(Model.grpproductdetail_result.Data.PROD_NO)&date='+grp_s_date,
                                   method: 'get',
                                   success: function(req) {
		                              //console.log(req)
                                     let data = JSON.parse(req)
                                     data = data.Data


		                                  // prod_name
                                         $('.content-wrapper').html('');
		                                  // console.log(data.Data[0])
                                        $('.prod_name').html(data[0].PROD_NAME);

                                         var s_date=data[0].S_DATE;
		                                  //  var s_date_s=s_date.substr(0,4)+"/"+s_date.substr(4,2)+"/"s_date.substr(6,2);
                                        $('.prod_date').html(s_date);

                                     for(let i in data) {
                                      $('.content-wrapper').append("");
                                      }
		                                  //$('.lightbox-moreGroup .prod_name').html(data[0].PROD_NAME);
		                              }
                               })



                }

                function calendar_number_click(k){

                     var calendar_NewArray = new Array();
                      calendar_NewArray = k.split(",");
                       console.log(calendar_NewArray[0]);
                       console.log(calendar_NewArray[1]);

                       $('#prod_no').val(calendar_NewArray[0]);
                       $('#grp_no').val(calendar_NewArray[1]);

                      $('#action_temp').val("1");
                         $('#transferForm').submit();
                }


                    function signupbtn_click(){

                         $('#action_temp').val("0");
                         $('#transferForm').submit();

                    }

                   function  more_get_grp_no(th){

                       //console.log(th);
                       var grp_no_more=$(th).attr("id");
                       //console.log(grp_no_more);
                       $("#more_grp_no").val(grp_no_more);
                   }

                   $('#transferForm').submit(function() {

                       console.log($('#action_temp').val());

                         return true;
                       });

            </script>


        </div>
    </div>
    
    <div class="content content-gray">
        <div class="star-container">
            <!-- 內選單 -->
            <div class="travel-innerMenu hidden-xs" id="travel-innerMenu">
                <a href="#travel-traffic">交通資訊</a>
                <a href="#travel-characteristics">行程特色</a>
                <a href="#travel-itinerary">行程介紹</a>
                <a href="#travel-cost">費用包含</a>
                <a href="#travel-description">作業說明</a>
            </div>

            @{
                                        /*DateTime DATE_AT_s = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                DateTime DEPARRT_TIME_s = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                DateTime ARRIVE_TIME_s = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                string AIR_NAME_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].AIR_NAME).ToString();
                string FLY_NO_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].FLY_NO).ToString();
                string CITY_FROM_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].CITY_FROM).ToString();
                string CITY_TO_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[0].CITY_TO).ToString();
                
                
                DateTime DATE_AT_e = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].DATE_AT).ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                DateTime DEPARRT_TIME_e = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].DEPARRT_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                DateTime ARRIVE_TIME_e = DateTime.ParseExact(Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].ARRIVE_TIME).ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);             
                string AIR_NAME_e = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].AIR_NAME).ToString();           
                string FLY_NO_e = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].FLY_NO).ToString();            
                string CITY_FROM_e = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].CITY_FROM).ToString();      
                string CITY_TO_e = Html.DisplayFor(model => model.grpproductdetail_result.Data.TrafficList[1].CITY_TO).ToString();*/

                                        //int transfer_all_count = Model.grpproductdetail_result.Data.TrafficList.Count;
                                        //int transfer_times_half = transfer_all_count / 2;
                                        // int transfer_times = transfer_times_half - 1;
                
                
            }





            <div id="travel-traffic" class="travel-block hidden-xs">
                <span class="h3 text-bold">交通資訊</span>
                <span class="text-orange">本商品所搭乘之交通，以行程確認單為準</span>
                <div class="travel-traffic-Go mt-20 row">
                    <div class="travel-traffic-img col-xs-3 col-md-1">
                        <img src="~/Content/images/flight-go.png" alt="">
                    </div>
                    <div class="travel-traffic-text col-xs-9 col-md-11">
                        <p>
                            @for (i = 0; i < transfer_times_half; i = i + 1)
                            {


                                DateTime DATE_AT_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                DateTime DEPARRT_TIME_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DEPARRT_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                DateTime ARRIVE_TIME_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].ARRIVE_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                string AIR_NAME_s = Model.grpproductdetail_result.Data.TrafficList[i].AIR_NAME.ToString();
                                string FLY_NO_s = Model.grpproductdetail_result.Data.TrafficList[i].FLY_NO.ToString();
                                string CITY_FROM_s = Model.grpproductdetail_result.Data.TrafficList[i].CITY_FROM_NAME.ToString();
                                string CITY_TO_s = Model.grpproductdetail_result.Data.TrafficList[i].CITY_TO_NAME.ToString();


                                if (i == 0)
                                {
                                    
                                  <font>  @DATE_AT_s.ToString("yyyy/MM/dd") @DEPARRT_TIME_s.ToString("HH:mm")-@(ARRIVE_TIME_s.ToString("HH:mm")) @AIR_NAME_s @FLY_NO_s @CITY_FROM_s→@CITY_TO_s</font>
                                }
                                else
                                {
                                    <br> @CITY_FROM_s @:/ 轉機 <br>
                                  <font>  @DATE_AT_s.ToString("yyyy/MM/dd") @DEPARRT_TIME_s.ToString("HH:mm")-@(ARRIVE_TIME_s.ToString("HH:mm")) @AIR_NAME_s @FLY_NO_s @CITY_FROM_s→@CITY_TO_s</font>
                                }

                            }
                           </p>
                   </div>
                </div>
                <div class="travel-traffic-Back row">
                    <div class="travel-traffic-img col-xs-3 col-md-1">
                        <img src="~/Content/images/flight-back.png" alt="">
                    </div>
                    <div class="travel-traffic-text col-xs-9 col-md-11">
                        <p>
                            @for (i = transfer_times_half; i < transfer_all_count; i = i + 1)
                            {


                                DateTime DATE_AT_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                DateTime DEPARRT_TIME_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DEPARRT_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                DateTime ARRIVE_TIME_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].ARRIVE_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                string AIR_NAME_e = Model.grpproductdetail_result.Data.TrafficList[i].AIR_NAME.ToString();
                                string FLY_NO_e = Model.grpproductdetail_result.Data.TrafficList[i].FLY_NO.ToString();
                                string CITY_FROM_e = Model.grpproductdetail_result.Data.TrafficList[i].CITY_FROM_NAME.ToString();
                                string CITY_TO_e = Model.grpproductdetail_result.Data.TrafficList[i].CITY_TO_NAME.ToString();


                                if (i == transfer_times_half)
                                {

                                    <font>  @DATE_AT_e.ToString("yyyy/MM/dd") @DEPARRT_TIME_e.ToString("HH:mm")-@(ARRIVE_TIME_e.ToString("HH:mm")) @AIR_NAME_e @FLY_NO_e @CITY_FROM_e→@CITY_TO_e</font>
                                }
                                else
                                {
                                    <br> @CITY_FROM_e @:/ 轉機 <br>
                                    <font>  @DATE_AT_e.ToString("yyyy/MM/dd") @DEPARRT_TIME_e.ToString("HH:mm")-@(ARRIVE_TIME_e.ToString("HH:mm")) @AIR_NAME_e @FLY_NO_e @CITY_FROM_e→@CITY_TO_e</font>
                                }

                            }


                        </p>
                    </div>
                </div>
            </div>
            <div class="panel-group travel-panel" role="tablist" aria-multiselectable="true">
                <!-- 區塊2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab">
                        <h4 class="panel-title">
                            <a href="#bbb" data-toggle="collapse" role="button" class="collapsed" aria-expanded="false" aria-controls="bbb">
                                交通資訊
                                <span>
                                    <i class="glyphicon glyphicon-chevron-up"></i>
                                    <i class="glyphicon glyphicon-chevron-down"></i>
                                </span>
                            </a>
                        </h4>
                    </div>
                    <div id="bbb" class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel2">
                        <div class="panel-body">
                            <div>
                                <span class="text-orange">本商品所搭乘之交通，以行程確認單為準</span>
                                <div class="travel-traffic-Go mt-20 row">
                                    <div class="travel-traffic-img col-xs-3 col-md-1">
                                        <img src="~/Content/images/flight-go.png" alt="">
                                    </div>
                                    <div class="travel-traffic-text col-xs-9 col-md-11">
                                        <p>
                                            @for (i = 0; i < transfer_times_half; i = i + 1)
                                            {


                                                DateTime DATE_AT_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                                DateTime DEPARRT_TIME_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DEPARRT_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                DateTime ARRIVE_TIME_s = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].ARRIVE_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                string AIR_NAME_s = Model.grpproductdetail_result.Data.TrafficList[i].AIR_NAME.ToString();
                                                string FLY_NO_s = Model.grpproductdetail_result.Data.TrafficList[i].FLY_NO.ToString();
                                                string CITY_FROM_s = Model.grpproductdetail_result.Data.TrafficList[i].CITY_FROM_NAME.ToString();
                                                string CITY_TO_s = Model.grpproductdetail_result.Data.TrafficList[i].CITY_TO_NAME.ToString();


                                                if (i == 0)
                                                {
                                                    @DATE_AT_s.ToString("yyyy/MM/dd") @DEPARRT_TIME_s.ToString("HH:mm")@:-@(ARRIVE_TIME_s.ToString("HH:mm")) @AIR_NAME_s @FLY_NO_s @CITY_FROM_s→@CITY_TO_s
                                                  }
                                                else
                                                {
                                                    <br> @CITY_FROM_s @:/ 轉機 <br>
                                                     @DATE_AT_s.ToString("yyyy/MM/dd") @DEPARRT_TIME_s.ToString("HH:mm")@:-@(ARRIVE_TIME_s.ToString("HH:mm")) @AIR_NAME_s @FLY_NO_s @CITY_FROM_s→@CITY_TO_s
                                                  }

                                            }
                                        </p>
                                    </div>
                                </div>
                                <div class="travel-traffic-Back row">
                                    <div class="travel-traffic-img col-xs-3 col-md-1">
                                        <img src="~/Content/images/flight-back.png" alt="">
                                    </div>
                                    <div class="travel-traffic-text col-xs-9 col-md-11">
                                        <p>
                                            @for (i = transfer_times_half; i < transfer_all_count; i = i + 1)
                                            {


                                                DateTime DATE_AT_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DATE_AT.ToString(), "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                                                DateTime DEPARRT_TIME_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].DEPARRT_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                DateTime ARRIVE_TIME_e = DateTime.ParseExact(Model.grpproductdetail_result.Data.TrafficList[i].ARRIVE_TIME.ToString(), "HHmmss", System.Globalization.CultureInfo.InvariantCulture);
                                                string AIR_NAME_e = Model.grpproductdetail_result.Data.TrafficList[i].AIR_NAME.ToString();
                                                string FLY_NO_e = Model.grpproductdetail_result.Data.TrafficList[i].FLY_NO.ToString();
                                                string CITY_FROM_e = Model.grpproductdetail_result.Data.TrafficList[i].CITY_FROM_NAME.ToString();
                                                string CITY_TO_e = Model.grpproductdetail_result.Data.TrafficList[i].CITY_TO_NAME.ToString();


                                                if (i == transfer_times_half)
                                                {

                                                    <font>  @DATE_AT_e.ToString("yyyy/MM/dd") @DEPARRT_TIME_e.ToString("HH:mm")-@(ARRIVE_TIME_e.ToString("HH:mm")) @AIR_NAME_e @FLY_NO_e @CITY_FROM_e→@CITY_TO_e</font>
                                                }
                                                else
                                                {
                                                    <br> @CITY_FROM_e @:/ 轉機 <br>
                                                    <font>  @DATE_AT_e.ToString("yyyy/MM/dd") @DEPARRT_TIME_e.ToString("HH:mm")-@(ARRIVE_TIME_e.ToString("HH:mm")) @AIR_NAME_e @FLY_NO_e @CITY_FROM_e→@CITY_TO_e</font>
                                                }

                                            }
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
















            <div id="travel-characteristics" class="travel-block hidden-xs">
                <span class="h3 text-bold">行程特色</span>
                <div class="travel-characteristics-text mt-10">
                    <div class="images-special">
                        <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL1)) center;"></div></div>
                        <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL2)) center;"></div></div>
                        <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL3)) center;"></div></div>
                        <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL4)) center;"></div></div>
                    </div>

                    <p>                      
                        @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_DESC3).ToString()))
                     </p>

                </div>
            </div>
            <div class="panel-group travel-panel" role="tablist" aria-multiselectable="true">
                <!-- 區塊2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab">
                        <h4 class="panel-title">
                            <a href="#aaa" data-toggle="collapse" role="button" class="collapsed" aria-expanded="false" aria-controls="bbb">
                                行程特色
                                <span>
                                    <i class="glyphicon glyphicon-chevron-up"></i>
                                    <i class="glyphicon glyphicon-chevron-down"></i>
                                </span>
                            </a>
                        </h4>
                    </div>
                    <div id="aaa" class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel2">
                        <div class="panel-body">

                            <div class="travel-characteristics-text mt-10">
                                <div class="images-special">
                                    <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL1)) center;"></div></div>
                                    <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL2)) center;"></div></div>
                                    <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL3)) center;"></div></div>
                                    <div class="img"><div style="background:url(http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.PIC_URL.URL4)) center;"></div></div>
                                </div><p>
                                    @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_DESC3).ToString()))  
                                </p>

                            </div>

                        </div>
                    </div>
                </div>
            </div>



            <div id="travel-itinerary" class="travel-block hidden-xs">
                <span class="h3 text-bold">行程介紹</span>
                <p class="travel-itinerary-icon">行程圖示說明：●下車照相 ◎入內參觀 ★特殊安排 ◆特別餐食 △特殊交通工具</p>

                @{
                                            int data_list_number = 0;    
                }
                @foreach (var item in Model.grpproductdetail_result.Data.DateList)
                {
                    data_list_number = data_list_number + 1;
                 <!-- Day01 -->
                <div class="travel-itinerary-day">
                    <div class="travel-itinerary-daycontent">
                        <div class="travel-itinerary-title">
                            <div class="travel-itinerary-titleDate">
                                第 <span>@data_list_number</span> 天
                            </div>                            
                            @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.PATH_TITLE).ToString()))
                        </div>
                        <div class="travel-itinerary-content row">
                            <div class="col-xs-12 col-sm-8">                          
                                @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.PATH_DESC).ToString()))
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <p>
                                    <img class="img-responsive mb-20" src="http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.URL)/@Html.DisplayFor(modelitem => item.DATEPIC_URL)" width="580" height="420">
                                 </p>
                            </div>
                        </div>
                        <div class="travel-itinerary-food">
                            <div class="travel-itinerary-food-icon">
                                <img src="~/Content/images/travel-food.png" alt="">
                            </div>
                             @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.MEAL).ToString()))
                        </div>
                        <div class="travel-itinerary-hotel">
                            <div class="travel-itinerary-hotel-icon">
                                <img src="~/Content/images/travel-hotel.png" alt="">
                            </div>
                           @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.HOTEL).ToString()))
                        </div>
                    </div>
                </div>
                <!-- Day01End -->
                }



            </div>
            <div class="panel-group travel-panel" role="tablist" aria-multiselectable="true">
                <!-- 區塊2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab">
                        <h4 class="panel-title">
                            <a href="#ccc" data-toggle="collapse" role="button" class="collapsed" aria-expanded="false" aria-controls="bbb">
                                行程介紹
                                <span>
                                    <i class="glyphicon glyphicon-chevron-up"></i>
                                    <i class="glyphicon glyphicon-chevron-down"></i>
                                </span>
                            </a>
                        </h4>
                    </div>
                    <div id="ccc" class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel2">
                        <div class="panel-body">

                            <p class="travel-itinerary-icon">行程圖示說明：●下車照相 ◎入內參觀 ★特殊安排 ◆特別餐食 △特殊交通工具</p>
      
                           @{ data_list_number = 0; }
                         @foreach (var item in Model.grpproductdetail_result.Data.DateList)
                         {
                            <!-- Day01 -->
                             data_list_number = data_list_number + 1;
                            <div class="travel-itinerary-day">
                                <div class="travel-itinerary-daycontent">
                                    <div class="travel-itinerary-title">
                                        <div class="travel-itinerary-titleDate">
                                            第 <span>@data_list_number</span> 天
                                        </div>
                                        @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.PATH_TITLE).ToString()))
                                    </div>
                                    <div class="travel-itinerary-content row">
                                        <div class="col-xs-12 col-sm-8">
                                            @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.PATH_DESC).ToString()))
                                        </div>
                                        <div class="col-xs-12 col-sm-4">
                                            <p>
                                                <img class="img-responsive mb-20" src="http://www.startravel.com.tw/@Html.DisplayFor(model => model.grpproductdetail_result.Data.URL)/@Html.DisplayFor(modelitem => item.DATEPIC_URL)" width="580" height="420">
                                            </p>
                                        </div>
                                    </div>
                                    <div class="travel-itinerary-food">
                                        <div class="travel-itinerary-food-icon">
                                            <img src="~/Content/images/travel-food.png" alt="">
                                        </div>
                                        @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.MEAL).ToString()))
                                    </div>
                                    <div class="travel-itinerary-hotel">
                                        <div class="travel-itinerary-hotel-icon">
                                            <img src="~/Content/images/travel-hotel.png" alt="">
                                        </div>
                                        @Html.Raw(Server.HtmlDecode(Html.DisplayFor(modelitem => item.HOTEL).ToString()))
                                    </div>
                                </div>
                                <div class="travel-itinerary-day-more">
                                    <a href="javascript:;" title="">看更多</a>
                                </div>
                            </div>
                            <!-- Day01End -->
                         }

                        </div>
                    </div>
                </div>
            </div>









            <div id="travel-cost" class="travel-block hidden-xs">
                <span class="h3 text-bold">費用包含</span>
                <p class="mt-10">
                    @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.FEE_CONTRAIN).ToString()))
                </p>
                <div class="travel-optional">
                    <div class="travel-optional-title">自費項目</div>
                    <div class="travel-optional-content">
                        
                        @for (var k = 0; k < Model.grpaddpurchase_result.Data.Count; k = k + 1)
                        {
                            var item = Model.grpaddpurchase_result.Data[k];
                            
                        <div class="row mb-10">
                            <div class="col-xs-12 col-sm-8">
                                @Html.DisplayFor(modelitem => item.PROD_SUB_NAME)
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <div class="row">                               
                                    <div class="col-xs-6">
                                        @{ int prod_sub_price_d = int.Parse(Html.DisplayFor(modelitem => item.PROD_SUB_PRICE).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);}
                                        NT$ <span class="text-orange2">@prod_sub_price_d</span>
                                    </div>
                                    <div class="col-xs-6 text-center">
                                        <a class="travel-optional-info lightboxOpen-control03" href="javascript:;" title="" onclick="changelightBox('  @Html.DisplayFor(modelitem => k)  ')">商品說明</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        }
                        

                    </div>
                </div>
            </div>

            <script>
                var ary = @Html.Raw(Json.Encode(Model.grpaddpurchase_result.Data));
                //console.log(ary);
                //console.log(ary[0].PROD_SUB_NAME);
                function changelightBox(k){
                  //  console.log(ary[parseInt(k)].PROD_SUB_NAME);
                    $('.lightboxOpen03 .tips').html(ary[parseInt(k)].PROD_SUB_NAME);
                    $('.lightboxOpen03 .money').html(ary[parseInt(k)].PROD_SUB_PRICE);
                    $('.lightboxOpen03 .product_des').html(ary[parseInt(k)].PROD_SUB_DESC);
                    
                }
              

            </script>

            <div class="panel-group travel-panel" role="tablist" aria-multiselectable="true">
                <!-- 區塊2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab">
                        <h4 class="panel-title">
                            <a href="#ddd" data-toggle="collapse" role="button" class="collapsed" aria-expanded="false" aria-controls="bbb">
                                費用包含
                                <span>
                                    <i class="glyphicon glyphicon-chevron-up"></i>
                                    <i class="glyphicon glyphicon-chevron-down"></i>
                                </span>
                            </a>
                        </h4>
                    </div>
                    <div id="ddd" class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel2">
                        <div class="panel-body">

                            <p>
                                @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.FEE_CONTRAIN).ToString()))
                            </p>
                            <div class="travel-optional">
                                <div class="travel-optional-title">自費項目</div>
                                <div class="travel-optional-content">

                        @for (var k = 0; k < Model.grpaddpurchase_result.Data.Count; k = k + 1)
                        {
                            var item = Model.grpaddpurchase_result.Data[k];      
                                    <div class="row mb-10">
                                        <div class="col-xs-12 col-sm-8">
                                            @Html.DisplayFor(modelitem => item.PROD_SUB_NAME)
                                        </div>
                                        <div class="col-xs-12 col-sm-4">
                                            <div class="row">
                                                <div class="col-xs-6">
                                                    @{ int prod_sub_price_d = int.Parse(Html.DisplayFor(modelitem => item.PROD_SUB_PRICE).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);}
                                                    NT$ <span class="text-orange2">@prod_sub_price_d</span>
                                                </div>
                                                <div class="col-xs-6 text-center">
                                                    <a class="travel-optional-info lightboxOpen-control03" href="javascript:;" title="" onclick="changelightBox('  @Html.DisplayFor(modelitem => k)  ')">商品說明</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                        }
                               
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>














            @{
                
                        string DUEDAY_PAY_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.DUEDAY_PAY).ToString();
                        string DUEDAY_DOC_s = Html.DisplayFor(model => model.grpproductdetail_result.Data.DUEDAY_DOC).ToString();
                        string current_daytime_30 = DateTime.Now.AddDays(15).ToString("yyyyMMdd");

                        DateTime DUEDAY_PAY;
                        DateTime DUEDAY_DOC;

                        if (DUEDAY_PAY_s.IsEmpty())
                        {
                            DUEDAY_PAY = DateTime.ParseExact(current_daytime_30, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                        }
                        else
                        {
                            DUEDAY_PAY = DateTime.ParseExact(DUEDAY_PAY_s, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                        }


                        if (DUEDAY_DOC_s.IsEmpty())
                        {
                            DUEDAY_DOC = DateTime.ParseExact(current_daytime_30, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                        }
                        else
                        {
                            DUEDAY_DOC = DateTime.ParseExact(DUEDAY_DOC_s, "yyyyMMdd", System.Globalization.CultureInfo.InvariantCulture);
                        }


                        int max_tourer_d = int.Parse(Html.DisplayFor(model => model.grpproductdetail_result.Data.MAX_TOURER).ToString(), System.Globalization.NumberStyles.AllowThousands | System.Globalization.NumberStyles.AllowDecimalPoint);

            }


            <div id="travel-description" class="travel-block hidden-xs">
                <span class="h3 text-bold">作業說明</span>
                <p class="mt-10">
                    (處理規定說明)<br>
                    1.成行人數 : @min_tourer_d.ToString()人以上成團     本團最大團員數 : @max_tourer_d.ToString()人<br>
                    2.訂金金額 : @pre_amt_d 元<br>
                    3.尾款繳交期限 : @DUEDAY_PAY.ToString("yyyy/MM/dd")<br>
                    4.證件繳交期限 : @DUEDAY_DOC.ToString("yyyy/MM/dd")<br>
                    <br>
                    (費用不包含)<br>
                        @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.FEE_NOT_CONTRAIN).ToString()))<br>
                    <br>
                    (備註)<br>
                    @Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NOTE).ToString()))<br>
                </p>
            </div>

            <div class="panel-group travel-panel" role="tablist" aria-multiselectable="true">
                <!-- 區塊2 -->
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab">
                        <h4 class="panel-title">
                            <a href="#eee" data-toggle="collapse" role="button" class="collapsed" aria-expanded="false" aria-controls="bbb">
                                作業說明
                                <span>
                                    <i class="glyphicon glyphicon-chevron-up"></i>
                                    <i class="glyphicon glyphicon-chevron-down"></i>
                                </span>
                            </a>
                        </h4>
                    </div>
                    <div id="eee" class="panel-collapse collapse" role="tabpanel" aria-labelledby="panel2">
                        <div class="panel-body">

                            <p>
                                <p>
                                (處理規定說明)<br>
                                1.成行人數 : @min_tourer_d.ToString()人以上成團     本團最大團員數 : @max_tourer_d.ToString()人<br>
                                2.訂金金額 : @pre_amt_d 元<br>                              
                                3.尾款繳交期限 : @DUEDAY_PAY.ToString("yyyy/MM/dd")<br>
                                4.證件繳交期限 : @DUEDAY_DOC.ToString("yyyy/MM/dd")<br>
                            </p>
                            <p>
                                <br>
                                (費用不包含)<br>
                                   <p>@Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.FEE_NOT_CONTRAIN).ToString()))</p>
                                <br>
                                (備註)<br>
                                <p>@Html.Raw(Server.HtmlDecode(Html.DisplayFor(model => model.grpproductdetail_result.Data.PROD_NOTE).ToString()))<br></p>
                                
                            </p>

                        </div>
                    </div>
                </div>
            </div>






        </div>
    </div>





    <div class="travel-mobile-bottom-signUp">
        <div class="row">
            <div class="col-xs-6">
                <span class="text-yellow">只剩 @qty_kk_d.ToString()位</span>
                <span class="travel-mobile-bottom-price">
                    <strong>@price_d.ToString("#,#") </strong> 元起
                </span>
                <a class="lightboxOpen-control01" href="javascript:;" title="">價格說明</a>
            </div>
            <div class="col-xs-6">
                <input type="button" class="travel-mobile-bottom-signUp-BTN"  onclick="signupbtn_click()" title="" value="立即報名">
            </div>
        </div>
    </div>













    <!-- footer======================================================================= -->
    <div class="footer">
        <!-- award -->
        <div class="footerAward">
            <div class="star-container">
                <ul>
                    <li>
                        <a href="javascript:;" title="">
                            <img src="~/Content/images/award-01.png" alt="">
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">
                            <img src="~/Content/images/award-02.png" alt="">
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">
                            <img src="~/Content/images/award-03.png" alt="">
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">
                            <img src="~/Content/images/award-04.png" alt="">
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- footermenu -->
        <div class="footerMenu">
            <div class="star-container">
                <ul>
                    <li>
                        <a href="javascript:;" title="">關於燦星</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">交易安全</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">隱私權條款</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">FAQ</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">策略聯盟</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">菁英募集</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">企業商務</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">福委會</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">寫信給我們</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">網站導覽</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">陸客來台</a>
                    </li>
                    <li>
                        <a href="javascript:;" title="">防詐騙聲明</a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- footerContent -->
        <div class="footerContent">
            <div class="star-container">
                <div class="row">
                    <div class="col-xs-12 col-md-4">
                        <a class="footerPhone" href="tel:0281783000" title="">訂購諮詢專線：(02)8178-3000</a>
                    </div>
                    <div class="col-xs-12 col-md-4">
                        <a class="footerPhone" href="tel:024128686" title="">全台門市訂購專線：(02)412-8686</a>
                    </div>
                    <div class="col-xs-12 col-md-4">
                        <a class="footerPhone" href="tel:0227900550" title="">企業服務專線：(02)2790-0550</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-4">
                        <strong class="footerContentTitle">燦星國際旅行社股份有限公司</strong>
                        總公司：<a href="javascript:;" target="_blank">台北市內湖區堤頂大道一段331號4樓</a><br>
                        訂購諮詢電話：<a href="tel:0281783000">(02)8178-3000</a><br>
                        || 週六日/ 國定假日 AM09:00~PM19:00 ||<br>
                        || 平日 週一 ~ 週五 AM08:00~AM02:00 ||<br>
                        傳真電話：070-10168-965<br>
                        客服信箱：<a href="mailto:service@startravel.com.tw">service@startravel.com.tw</a>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <strong class="footerContentTitle">全台服務據點</strong>
                        代表門市<br>
                        台北寧夏店 (02)2556-1226<br>
                        台北南京旗艦店 (02)6608-8155<br>
                        新北蘆洲門市 (02)2281-6076<br>
                        新北土城門市 (02)8261-6403<br>
                        桃園八德門市 (03)361-8368<br>
                        新竹竹科門市 (03)578-5377<br>
                        苗栗竹南門市 (037)550-545<br>
                        台中門市 (04)3600-6799<br>
                        台南永華店 (06)293-3200<br>
                        高雄門市 (07)969-6618
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <strong class="footerContentTitle">企業服務 </strong>
                        服務項目：獎勵旅遊、商務差旅、員工旅遊、自組一團、公家機關<br>
                        專線：(02)2790-0550、(02)81783000#8151<br>
                        信箱：mice01@startravel.com.tw <br>
                        週一~週五 AM9:00-PM18:00<br>
                        <br>
                        <strong class="footerContentTitle">同業聯絡</strong>
                        <a href="http://goo.gl/ZEItJe" title="" target="_blank">http://goo.gl/ZEItJe</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- footerCertification -->
        <div class="footerCertification">
            <div class="star-container">
                <ul>
                    <li>
                        <a class="footer-icon01" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon02" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon03" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon04" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon05" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon06" href="javascript:;" title="" target="_blank"></a>
                    </li>
                    <li>
                        <a class="footer-icon07" href="javascript:;" title="" target="_blank"></a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- footerCopyright -->
        <div class="footerCopyright">
            <div class="star-container">
                ‧代表人：陳彥君 ‧聯絡人：鐘長利  綜合旅行社‧交觀綜字第2136號‧旅行社品質保障協會100字第北1819號 © 燦星旅遊版權所有盜用必究　All Rights Reserved.
            </div>
        </div>

    </div>












    <!-- footer-mobile=============================================================== -->
    <div class="footer-mobile">
        <div>
            <span class="text-purple text-bold">訂購諮詢專線：(02)8178-3000</span>
        </div>
        <div class="bg-w">
            燦星國際旅行社股份有限公司<br>
            總公司：台北市內湖區堤頂大道一段331號4樓<br>
            訂購諮詢電話：(02)8178-3000<br>
            || 週六日/ 國定假日 AM09:00~PM19:00 ||<br>
            || 平日 週一 ~ 週五 AM08:00~AM02:00 ||<br>
            傳真電話：070-10168-965<br>
            客服信箱：service@startravel.com.tw
        </div>
        <div>
            <span class="text-purple text-bold">全台門市訂購專線：(02)412-8686</span>
        </div>
        <div class="bg-w">
            <a href="javascript:;" title="">全台服務據點</a>
        </div>
        <div>
            <span class="text-purple text-bold">企業服務專線：(02)2790-0550</span>
        </div>
        <div class="bg-w">
            專線：<br>
            (02)2790-0550<br>
            (02)81783000#8151<br>
            信箱：mice01@startravel.com.tw <br>
            週一~週五 AM9:00-PM18:00
        </div>
        <div>
            代表人：陳彥君 / 聯絡人：鐘長利<br>
            綜合旅行社 / 交觀綜字第2136號 / 旅行社品質保障協會100字第北1819號<br>
            © 燦星旅遊版權所有盜用必究 All Rights Reserved.
        </div>
    </div>









    <!-- gotoTop==================================================================== -->
    <div class="gotoTop">
        <a href="javascript:;" id="topBTN">
            <img src="~/Content/images/gotoTop.png" alt="">
        </a>
    </div>



    <!-- 光箱打開 -->
    <div class="lightboxOpen lightboxOpen01">
        <div class="lightbox-box">
            <div class="lightbox-title">
                價格說明
            </div>
            <div class="lightbox-content">
                <div class="table-responsive">
                    <table class="table text-center">
                        <tbody>
                            <tr>

                               

                                 @foreach (var item in Model.grppriceinfo_result.Data)
                                 {
                                     foreach (var item_s in item.Role_Type)
                                     {
                                         if (item_s.Price != 0)
                                         {
                                             <td>@Html.DisplayFor(modelitem => item.Category_name)<br>@Html.DisplayFor(modelitem_s => item_s.Type_name)</td>
                                         }
                                     }
                                 }
                            </tr>
                            <tr>
                                @foreach (var item in Model.grppriceinfo_result.Data)
                                {
                                    foreach (var item_s in item.Role_Type)
                                    {
                                        if (item_s.Price != 0)
                                        {
                                         <td>@item_s.Price.ToString("#,#")</td>
                                        }
                                    }
                                }
                               
 
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p>
                    3期<br>
                    花旗、玉山、永豐、國泰世華、台北富邦、滙豐、澳盛、聯邦、大眾、遠銀、兆豐、中信、台新、華南、凱基、新光、上海商銀(106/6/1~106/12/31)<br>
                    <br>
                    4期  日盛(106/1/1~106/12/31，需單筆滿NT$3,000(含)以上，並於刷卡前致電02-2951-6000按【666】->再按【6】或至日盛銀行網站登錄) <br>
                    5期  玉山、永豐、國泰世華、台北富邦<br>
                    6期  花旗、中信、滙豐、遠銀、大眾、聯邦、兆豐、華南、永豐、凱基、新光、台新、上海商銀(106/6/1~106/12/31)<br>
                    <br>
                  
                </p>
                <a class="lightboxClose" href="javascript:;" title=""><i class="glyphicon glyphicon-remove"></i></a>
            </div>
        </div>
    </div>



    <!-- 光箱打開2 -->
    <div class="lightboxOpen lightboxOpen02">
        <div class="lightbox-box">
            <div class="lightbox-title">
                促銷方案
            </div>
            <div class="lightbox-content">
                <p>
                    <span class="text-red">～限量超狂優惠～</span><br>
                    指定行程、出發日、旅展最低價限量供應，售完不再加開，挑戰價格無極限！<br>
                    即日起完成報名付訂付即可享超低價$２５,９００元，機會難得，機會稍縱即逝！ <br>
                    **《優惠僅限全程參團》，舉凡湊票、JOIN TOUR、嬰兒不適用此優惠，且不得與其他優惠活動、ECASH、折價券併用。 <br>
                    <br>
                    ★★特別安排搭乘【津輕海峽FERRY】～飽覽連結北海道及本州青森縣的湛藍大海★★<br>
                    津輕海峽是介於日本本州及北海道兩大本島之間的海峽，以本州側的津輕半島而得名，東連太平洋、西連日本海，東西長約130公里，水深最大達450公尺。坐上行駛於連接青森縣至北海道函館間的渡輪，在各季節各期間都有不同的海景映入眼簾，幸運的話還有機會能近距離觀賞到海豚的泳姿，飽覽青森至北海道之間的湛藍大海，體驗與眾不同的渡輪之旅。
                </p>
            </div>
            <a class="lightboxClose" href="javascript:;" title=""><i class="glyphicon glyphicon-remove"></i></a>
        </div>
    </div>


    <!-- 光箱打開3 -->
    <div class="lightboxOpen lightboxOpen03">
        <div class="lightbox-box">
            <div class="lightbox-title">
                商品說明
            </div>
            <div class="lightbox-content">
                <div class="row mb-10">
                    <div class="col-xs-12 col-sm-4 text-center" style="background-color: #fffb98;padding:10px 20px;">
                        商品名稱
                    </div>
                    <div class="col-xs-12 col-sm-8 tips" style="padding:10px 20px;">
                        小費
                    </div>
                </div>
                <div class="row mb-10">
                    <div class="col-xs-12 col-sm-4 text-center" style="background-color: #fffb98;padding:10px 20px;">
                        費用
                    </div>
                    <div class="col-xs-12 col-sm-8 money" style="padding:10px 20px;">
                        NT$5,000
                    </div>
                </div>
                <div class="row mb-10">
                    <div class="col-xs-12 col-sm-4 text-center" style="background-color: #fffb98;padding:10px 20px;">
                        商品內容說明
                    </div>
                    <div class="col-xs-12 col-sm-8 product_des" style="padding:10px 20px;">
                        文字文字文字文字文字文字文字文字文字文字文字文字文字文字文字文字<br>
                        文字文字文字文字文字文字<br>
                        文字文字文字文字文字文字文字文字文字文字
                    </div>
                </div>
            </div>
            <a class="lightboxClose" href="javascript:;" title=""><i class="glyphicon glyphicon-remove"></i></a>
        </div>
    </div>



    <!-- 光箱打開-moreGroup -->
  <div class="lightboxOpen lightbox-moreGroup">
    <div class="lightbox-box">
      <div class="lightbox-title prod_name">
        愛老虎北海道！【升等2晚五星★蒙特利】米其林函館夜景、騎馬體驗
      </div>
      <div class="lightbox-content">
        <h3 class="prod_date">2017/10/31(二)    當日更多團</h3>
          <div class="content-wrapper">
              <div class="moreGroup-block mb-20">
                  <div class="row mb-10">
                      <div class="col-xs-12 col-sm-12">
                          團號  RN0000015310 <a class="ensure">保出</a> 可報名團人數：5人
                      </div>
                  </div>
                  <div class="row">
                      <div class="col-xs-12 col-sm-9">
                          2017/09/20  12:30-15:55  長榮航空 BR130M 桃園國際機場→關西國際機場<br>
                          <span class="text-blue2">關西國際機場 / 轉機</span><br>
                          2017/09/20  20:50-09:35  夏威夷航空 HA4501 關西國際機場→夏威夷檀香山
                      </div>
                      <div class="col-xs-12 col-sm-3 text-right">
                          <h2 class="text-orange text-bold mt-0">32,900 <small>元</small></h2>
                          <a class="moreGroup-btn moreGroup-btn-see" href="javascript:;" title="">查看</a>
                      </div>
                  </div>
              </div>
          </div>
        
      </div>
      <a class="lightboxClose" href="javascript:;" title=""><i class="glyphicon glyphicon-remove"></i></a>
    </div>
  </div>






    <!-- 內選單 固定上方 -->
    <div class="travel-innerMenu-fixed hidden-xs" id="travel-innerMenu-fixed">
        <div class="star-container">
            <ul class="nav nav-tabs" role="tablist">
                <li class="fixed-menu-1"><a  href="#travel-traffic">交通<span class="hidden-xs">資訊</span></a></li>
                <li class="fixed-menu-2"><a href="#travel-characteristics"><span class="hidden-xs">行程</span>特色</a></li>
                <li class="fixed-menu-3"><a href="#travel-itinerary">行程<span class="hidden-xs">介紹</span></a></li>
                <li class="fixed-menu-4"><a href="#travel-cost">費用<span class="hidden-xs">包含</span></a></li>
                <li class="fixed-menu-5"><a href="#travel-description"><span class="hidden-xs">作業</span>說明</a></li>
            </ul>
            <input type="button" class="travel-innerMenu-fixed-signUpBtn"  onclick="signupbtn_click()" title="" value="立即報名">

        </div>
    </div>



    <script>
        $(document).ready(function() {
            $('.nav-tabs a, #travel-innerMenu a').click(function(e) {
                let target = $(this).attr('href')
                $("html, body").animate({ scrollTop: $(target).offset().top -60 }, 600);
                e.preventDefault();
            })
        })
    </script>





    <!-- 依需要參考已編譯外掛版本（如下），或各自獨立的外掛版本 -->
    <!--<script type="text/javascript" src="~/Scripts/bootstrap.js"></script>-->

    <!--<script type="text/javascript" src="~/Scripts/star-js.js"></script>-->


}

</body>
</html>